(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Systemusers"],{"414b":function(t,e,i){"use strict";var s=function(){var t=this,e=t._self._c;return e("v-tooltip",{attrs:{top:""},scopedSlots:t._u([{key:"activator",fn:function({on:i,attrs:s}){return[e("v-btn",t._g(t._b({class:t.childClass,on:{click:function(e){return t.$emit("click")}}},"v-btn",{...s,...t.$attrs},!1),i),[t._t("default")],2)]}}],null,!0)},[e("span",[t._v(t._s(t.label))])])},a=[],l={name:"TooltipBtn",props:{label:{type:String,required:!0},childClass:[String,Object]}},r=l,n=i("2877"),o=Object(n["a"])(r,s,a,!1,null,null,null);e["a"]=o.exports},"8fac":function(t,e,i){"use strict";var s=function(){var t=this,e=t._self._c;return e("v-text-field",t._b({ref:"field",attrs:{value:t.value,maxlength:t.$attrs.counter,"error-messages":t.errMsg,"success-messages":t.successMsg},on:{input:t.onInput},scopedSlots:t._u([t.isCheck?null:{key:"append",fn:function(){return[e("v-tooltip",{attrs:{top:""},scopedSlots:t._u([{key:"activator",fn:function({on:i,attrs:s}){return[e("v-btn",t._g(t._b({attrs:{icon:"",small:"",tabindex:"-1",loading:t.loading},on:{click:t.check}},"v-btn",s,!1),i),[e("v-icon",[t._v("mdi-check")])],1)]}}],null,!1,1344435932)},[t._v(" "+t._s(t.$attrs.label)+" 중복검사 ")])]},proxy:!0}],null,!0)},"v-text-field",t.$attrs,!1))},a=[],l={name:"InputDuplicateDualCheck",model:{prop:"value",event:"input"},props:{value:String,cbCheck:{type:Function,default:null},origin:{type:String,default:""},aFiled:{type:String,default:""}},watch:{origin(){this.isCheck=!!this.origin||!this.cbCheck}},data(){return{isCheck:!!this.origin||!this.cbCheck,loading:!1,errMsg:"",successMsg:""}},computed:{isSend(){return!!this.cbCheck&&0===this.$refs.field.errorBucket.length}},mounted(){},methods:{onInput(t){this.isCheck=this.origin?this.origin===t:!this.cbCheck,this.errMsg="",this.successMsg="",this.$emit("input",t)},init(){this.errMsg="",this.successMsg=""},async check(){if(!this.isSend)return;this.loading=!0,this.errMsg="",this.successMsg="";const t=await this.cbCheck(this.value,this.aFiled);this.value?0==t.cnt?(this.successMsg=`사용 가능한 ${this.$attrs.label} 입니다.`,this.isCheck=!0):(this.errMsg=`중복된 ${this.$attrs.label} 입니다.`,this.isCheck=!1):this.successMsg="",this.loading=!1},validate(){return this.isCheck||(this.errMsg=this.$attrs.label+" 중복검사를 해주세요.",this.$refs.field.focus()),this.isCheck}}},r=l,n=i("2877"),o=Object(n["a"])(r,s,a,!1,null,null,null);e["a"]=o.exports},"98e2":function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t._self._c;return e("v-container",{attrs:{fluid:""}},[e("v-toolbar",{attrs:{height:"40px","background-color":"primary",dark:""}},[e("v-toolbar-title",[t._v("사용자 관리")]),e("v-spacer"),e("tooltip-btn",{attrs:{label:"조회"},on:{click:t.fetchData}},[e("v-icon",[t._v("mdi-magnify")])],1),e("tooltip-btn",{attrs:{label:"추가"},on:{click:t.addUser}},[e("v-icon",[t._v("mdi-plus")])],1),e("tooltip-btn",{attrs:{label:"삭제"},on:{click:t.delUser}},[e("v-icon",[t._v("mdi-minus")])],1)],1),e("v-data-table",{staticClass:"elevation-1 text-no-wrap",attrs:{headers:t.headers,items:t.items,"item-key":"i_id","single-select":"","items-per-page":-1,"hide-default-footer":"","footer-props":{"items-per-page-options":[10,20,30,40,50,100,-1]},height:t.iframeHeight},on:{"click:row":t.rowSelect,"dblclick:row":t.showRowInfo},scopedSlots:t._u([{key:"item.i_level",fn:function({item:e}){return[t._v(" "+t._s(t.getLvlabel(e.i_level))+" ")]}}],null,!0)}),e("ez-dialog",{ref:"dialog",attrs:{label:"사용자 추가/수정",persistent:"",width:"350px"},on:{onClose:t.closeDialog}},[e("user-form",{attrs:{data:t.item,keyCheckId:t.keyCheckId,isLoad:t.isLoad},on:{onSave:t.save}})],1)],1)},a=[],l=(i("14d9"),i("2f62")),r=i("64f2"),n=i("bb5e"),o=i("a2e4"),c=i("414b"),u=function(){var t=this,e=t._self._c;return e("v-container",{staticClass:"grey lighten-5"},[e("v-form",{ref:"form",attrs:{"lazy-validation":""},on:{submit:function(e){return e.preventDefault(),t.save.apply(null,arguments)}},model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[e("input-duplicate-dual-check",{ref:"i_id",attrs:{label:"ID",aFiled:t.form.c_com,cbCheck:t.keyCheckId,origin:t.originKeyId,readonly:!!t.data,rules:[t.rules.require({label:"ID"}),t.rules.alphaNum()]},model:{value:t.form.i_id,callback:function(e){t.$set(t.form,"i_id",e)},expression:"form.i_id"}}),e("v-text-field",{ref:"p_password",attrs:{label:"성명"},model:{value:t.form.n_name,callback:function(e){t.$set(t.form,"n_name",e)},expression:"form.n_name"}}),e("input-password",{attrs:{label:"비밀번호",rules:t.rules.password2({label:"비밀번호",required:!1,len:3})},model:{value:t.form.p_password,callback:function(e){t.$set(t.form,"p_password",e)},expression:"form.p_password"}}),e("v-select",{attrs:{laebl:"사용등급",items:t.lvitems,"item-text":"label","item-value":"lv"},model:{value:t.form.i_level,callback:function(e){t.$set(t.form,"i_level",e)},expression:"form.i_level"}}),e("input-radio",{attrs:{label:"사용여부",row:"",items:t.yesnoItem,rules:[t.rules.require({label:"사용"})]},model:{value:t.form.f_use,callback:function(e){t.$set(t.form,"f_use",e)},expression:"form.f_use"}}),e("v-textarea",{attrs:{label:"설명"},model:{value:t.form.t_remark,callback:function(e){t.$set(t.form,"t_remark",e)},expression:"form.t_remark"}}),e("v-btn",{attrs:{type:"submit",color:"primary",block:""}},[t._v("저장")])],1)],1)},d=[],h=i("248f"),m=i.n(h),f=i("8fac"),p=i("445e"),v=i("f075"),_={components:{InputDuplicateDualCheck:f["a"],InputPassword:p["a"],InputRadio:v["a"]},name:"UserForm",props:{data:{type:Object,default:null},keyCheckId:{type:Function,default:null},isLoad:{type:Boolean,default:null}},data(){return{valid:!0,form:{c_com:"",i_id:"",n_name:"",p_password:"",i_level:6,f_use:"Y",t_remark:""},yesnoItem:[{label:"사용",value:"Y"},{label:"중지",value:"N"}],lvitems:null}},created(){this.init(),this.lvitems=n["LVITEMS2"]},watch:{isLoad(){this.init()}},computed:{rules:()=>m.a,originKeyId(){return this.data?this.data.i_id:""}},methods:{async init(){this.data?this.form=Object(r["deepCopy"])(this.data):this.form={c_com:this.$store.state.user.member.c_com,i_id:"",n_name:"",f_use:"Y",p_password:"",i_level:6,t_remark:""},this.form.p_password="",this.$refs.form&&(this.$refs.form.resetValidation(),this.$refs.i_id.init())},async save(){this.$refs.form.validate(),await this.$nextTick(),this.valid&&this.$refs.i_id.validate()&&(this.$emit("onSave",this.form),this.init())}}},b=_,g=i("2877"),k=Object(g["a"])(b,u,d,!1,null,null,null),w=k.exports,y={components:{TooltipBtn:c["a"],EzDialog:o["a"],UserForm:w},name:"Systemusers",mounted(){window.addEventListener("resize",this.adjustIframeHeight),this.adjustIframeHeight(),this.init()},beforeDestroy(){window.removeEventListener("resize",this.adjustIframeHeight)},data(){return{iframeHeight:500,headers:[{text:"ID",value:"i_id",sortable:!0,align:"center"},{text:"성명",value:"n_name",sortable:!0,align:"center"},{text:"등급",value:"i_level",sortable:!0,align:"center",width:"100px"},{text:"사용",value:"f_use",sortable:!0,align:"center",width:"100px"},{text:"접속일",value:"d_login_at",sortable:!1,align:"center",width:"150px"},{text:"생성일",value:"d_create_at",sortable:!1,align:"center",width:"150px"},{text:"갱신일",value:"d_update_at",sortable:!1,align:"center",width:"150px"}],items:[],item:null,isLoad:!1,selected:[]}},watch:{},computed:{},methods:{...Object(l["b"])("system",["duplicateDualCheck","iuWorkUser"]),adjustIframeHeight(){const t=window.innerHeight;this.iframeHeight=t-200},getLvlabel(t){var e=n["LVITEMS"].findIndex(e=>e.lv==t);return t>-1?n["LVITEMS"][e].label:t},rowSelect:function(t,e){e.select(!0),this.item=t,this.$emit("onSelect",t)},async init(){this.fetchData()},async fetchData(){this.items.splice(0),this.items=await this.$axios.get("/api/system/worksiteusers")},async addUser(){this.isLoad=!0,this.item=null,this.$refs.dialog.open()},async delUser(){const t=this.items.indexOf(this.item);if(t<0)return;if(!this.item)return;const e=await this.$ezNotify.confirm(`<b>성명 : ${this.item.n_name}</b><br> 삭제 하시겠습니까 ? <br> 삭제한 ID는 사용 불가 합니다.`,`ID : ${this.item.i_id} 삭제`,{icon:"mdi-delete",iconColor:"red"});if(!e)return;const i=await this.$axios.delete(`/api/system/delWorkUser/${this.item.c_com}/${this.item.i_id}`);i&&this.items.splice(t,1),this.$toast.info(`[${this.item.n_name}] 삭제 하였습니다.`)},async showRowInfo(t,{item:e}){this.isLoad=!0,this.item=e,this.$refs.dialog.open()},async keyCheckId(t,e){const i={com:"c_com",aFiled:e,field:"i_id",value:t};return await this.duplicateDualCheck(i)},async save(t){this.isLoading=!0,t.p_password||delete t.p_password;const e=await this.iuWorkUser(t);if(this.isLoading=!1,e){this.$toast.info(`[${e.n_name}] 저장 하였습니다.`);const t=this.items.indexOf(this.item);t>=0?this.items.splice(t,1,e):this.items.push(e)}this.$refs.dialog.close()},closeDialog(){this.isLoad=!1,this.item=null}}},$=y,x=Object(g["a"])($,s,a,!1,null,null,null);e["default"]=x.exports},a2e4:function(t,e,i){"use strict";var s=function(){var t=this,e=t._self._c;return e("v-dialog",t._b({model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},"v-dialog",t.$attrs,!1),[e("v-card",[e("v-toolbar",[e("v-toolbar-title",[t._v(t._s(t.label))]),e("v-spacer"),t.obtn?e("v-btn",{attrs:{color:"primary",small:""},on:{click:t.btnClick}},[t._v(" "+t._s(t.obtn)+" ")]):t._e(),e("v-btn",{attrs:{icon:""},on:{click:t.close}},[e("v-icon",[t._v("mdi-close")])],1)],1),e("v-card-text",[t._t("default")],2)],1)],1)},a=[],l={name:"ezDialog",props:{label:{type:String,required:!0},obtn:{type:String}},data(){return{dialog:!1}},methods:{close(){this.dialog=!1,this.$emit("onClose")},open(){this.$emit("onOpen"),this.dialog=!0},btnClick(){this.dialog=!1,this.$emit("btnClick")}}},r=l,n=i("2877"),o=Object(n["a"])(r,s,a,!1,null,null,null);e["a"]=o.exports}}]);
//# sourceMappingURL=Systemusers.b4a51b91.js.map
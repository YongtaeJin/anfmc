(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["AdmWorksite"],{"414b":function(t,e,i){"use strict";var s=function(){var t=this,e=t._self._c;return e("v-tooltip",{attrs:{top:""},scopedSlots:t._u([{key:"activator",fn:function({on:i,attrs:s}){return[e("v-btn",t._g(t._b({class:t.childClass,on:{click:function(e){return t.$emit("click")}}},"v-btn",{...s,...t.$attrs},!1),i),[t._t("default")],2)]}}],null,!0)},[e("span",[t._v(t._s(t.label))])])},o=[],a={name:"TooltipBtn",props:{label:{type:String,required:!0},childClass:[String,Object]}},r=a,n=i("2877"),l=Object(n["a"])(r,s,o,!1,null,null,null);e["a"]=l.exports},"46e0":function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t._self._c;return e("v-container",{attrs:{fluid:""}},[e("v-toolbar",{attrs:{height:"40px","background-color":"primary",dark:""}},[e("v-toolbar-title",[t._v("사업장 관리")]),e("v-spacer"),e("tooltip-btn",{attrs:{fab:"",small:"",label:"추가"},on:{click:t.addWorkSite}},[e("v-icon",[t._v("mdi-plus")])],1),e("tooltip-btn",{attrs:{fab:"",small:"",label:"조회"},on:{click:t.fetchData}},[e("v-icon",[t._v("mdi-magnify")])],1)],1),e("v-data-table",{staticClass:"elevation-1 text-no-wrap",attrs:{headers:t.headers,items:t.items,"item-key":"i_ser","single-select":"","items-per-page":-1,"hide-default-footer":"","footer-props":{"items-per-page-options":[10,20,30,40,50,100,-1]},height:"400px","max-height":"400px"},on:{"dblclick:row":t.showRowInfo,"click:row":t.showWorkSiteLog},scopedSlots:t._u([{key:"item.f_init",fn:function({item:i}){return[e("v-btn",{attrs:{icon:"","x-small":"",tabindex:"-1"},on:{click:function(e){return t.clickInit(i)}}},[e("v-icon",[t._v(" mdi-dialpad ")])],1)]}}],null,!0)}),e("v-toolbar",{attrs:{height:"30px","background-color":"primary",dark:""}},[e("v-toolbar-title",[t._v("회사 Log Image")]),e("v-spacer"),e("tooltip-btn",{attrs:{fab:"",small:"",label:"등록"},on:{click:t.clickLogImage}},[e("v-icon",[t._v("mdi-plus")])],1)],1),e("div",[e("v-img",{attrs:{src:t.siteImglog,"max-width":"200","max-height":"100"}})],1),e("ez-dialog",{ref:"dialog",attrs:{label:"사업장",persistent:"",width:"500px"},on:{onClose:t.closeDialog}},[e("worksite-form",{attrs:{data:t.item,keyCheckCom:t.keyCheckCom,keyCheckId:t.keyCheckId,isLoad:t.isLoad},on:{onSave:t.save}})],1),e("ez-dialog",{ref:"dialog_log",attrs:{label:"회사 Log Image 선택",persistent:"",width:"400px"}},[e("work-site-image",{attrs:{c_com:t.selected.c_com},on:{onSave:t.saveimgage}})],1)],1)},o=[],a=i("2f62"),r=i("414b"),n=i("a2e4"),l=function(){var t=this,e=t._self._c;return e("v-container",{staticClass:"grey lighten-5"},[e("v-form",{ref:"form",attrs:{"lazy-validation":""},on:{submit:function(e){return e.preventDefault(),t.save.apply(null,arguments)}},model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[e("v-row",{attrs:{"no-gutters":""}},[e("v-responsive",{attrs:{width:"60px"}},[e("input-duplicate-check",{ref:"c_com",attrs:{label:"사업장코드",cbCheck:t.keyCheckCom,origin:t.originKeyCom,readonly:!!t.data,rules:[t.rules.require({label:"사업장코드"}),t.rules.alphaNum()]},model:{value:t.form.c_com,callback:function(e){t.$set(t.form,"c_com",e)},expression:"form.c_com"}})],1),e("v-spacer"),e("v-text-field",{attrs:{label:"사업장명",rules:t.rules.name({label:"사업장명"})},model:{value:t.form.n_com,callback:function(e){t.$set(t.form,"n_com",e)},expression:"form.n_com"}})],1),e("v-row",{attrs:{"no-gutters":""}},[e("v-responsive",{attrs:{width:"60px"}},[e("input-duplicate-dual-check",{ref:"i_id",attrs:{label:"관리자ID",aFiled:t.form.c_com,cbCheck:t.keyCheckId,origin:t.originKeyId,readonly:!!t.data,rules:[t.rules.require({label:"관리자ID"}),t.rules.alphaNum()]},model:{value:t.form.i_id,callback:function(e){t.$set(t.form,"i_id",e)},expression:"form.i_id"}})],1),e("v-spacer"),e("v-text-field",{attrs:{label:"관리자성명",rules:t.rules.name({label:"관리자성명"})},model:{value:t.form.n_name,callback:function(e){t.$set(t.form,"n_name",e)},expression:"form.n_name"}})],1),e("v-row",{attrs:{"no-gutters":""}},[e("v-responsive",{attrs:{width:"60px"}},[e("v-text-field",{attrs:{label:"사용여부",readonly:!0},scopedSlots:t._u([{key:"append",fn:function(){return[e("v-btn",{attrs:{small:"",icon:""},on:{click:t.setUseYN}},[e("v-icon",[t._v("mdi-check")])],1)]},proxy:!0}]),model:{value:t.form.f_use,callback:function(e){t.$set(t.form,"f_use",e)},expression:"form.f_use"}})],1),e("v-spacer"),e("v-text-field",{attrs:{label:"비밀번호",rules:t.rules.password2({len:3})},model:{value:t.form.p_pw,callback:function(e){t.$set(t.form,"p_pw",e)},expression:"form.p_pw"}})],1),e("v-row",{attrs:{"no-gutters":""}},[e("v-responsive",{attrs:{width:"60px"}},[e("v-text-field",{attrs:{label:"사업자번호"},model:{value:t.form.i_company,callback:function(e){t.$set(t.form,"i_company",e)},expression:"form.i_company"}})],1),e("v-spacer"),e("v-text-field",{attrs:{label:"KPI 인증키"},model:{value:t.form.i_kpikey,callback:function(e){t.$set(t.form,"i_kpikey",e)},expression:"form.i_kpikey"}})],1),e("v-row",{attrs:{"no-gutters":""}},[e("v-responsive",{attrs:{width:"130px"}}),e("v-spacer"),e("v-text-field",{attrs:{label:"KPI 인증키 등록 회사명",readonly:"",color:"red"},scopedSlots:t._u([{key:"append",fn:function(){return[e("v-btn",{attrs:{small:"",icon:""},on:{click:t.kpichk}},[e("v-icon",[t._v("mdi-check")])],1)]},proxy:!0}]),model:{value:t.form.n_kpiconm,callback:function(e){t.$set(t.form,"n_kpiconm",e)},expression:"form.n_kpiconm"}})],1),e("v-text-field",{attrs:{label:"장비모니터링주소"},model:{value:t.form.t_monitor,callback:function(e){t.$set(t.form,"t_monitor",e)},expression:"form.t_monitor"}}),e("v-textarea",{attrs:{label:"설명"},model:{value:t.form.t_remark,callback:function(e){t.$set(t.form,"t_remark",e)},expression:"form.t_remark"}}),e("v-btn",{attrs:{type:"submit",block:""}},[t._v("저장")])],1)],1)},c=[],m=i("64f2"),u=i("248f"),d=i.n(u),h=i("50d8"),p=i("8fac"),f=i("445e"),_={components:{InputDuplicateCheck:h["a"],InputPassword:f["a"],InputDuplicateDualCheck:p["a"]},name:"WorksiteForm",props:{data:{type:Object,default:null},keyCheckCom:{type:Function,default:null},keyCheckId:{type:Function,default:null},isLoad:{type:Boolean,default:null}},data(){return{textColor:"red",valid:!0,form:{c_com:"",n_com:"",n_name:"",i_id:"",f_use:"",p_pw:"",i_company:"",i_kpikey:"",f_kpichk:"",n_kpiconm:"",t_monitor:"",t_worklog:"",t_worksign:"",t_remark:""},isNew:!1}},created(){this.init()},watch:{data(){this.init()},isLoad(){this.init()},"form.c_com"(){this.$refs.i_id.init()}},computed:{rules:()=>d.a,originKeyCom(){return this.data?this.data.c_com:""},originKeyId(){return this.data?this.data.i_id:""}},methods:{async init(){this.data?(this.form=Object(m["deepCopy"])(this.data),this.isNew=!1):(this.form={c_com:"",n_com:"",n_name:"",i_id:"",f_use:"Y",p_pw:"",i_company:"",i_kpikey:"",f_kpichk:"N",n_kpiconm:"",t_monitor:"",t_remark:""},this.isNew=!0),this.$refs.form&&(this.$refs.form.resetValidation(),this.$refs.c_com.init(),this.$refs.i_id.init())},setUseYN(){this.form.f_use="Y"==this.form.f_use?"N":"Y"},async kpichk(){const t=await this.$axios.post("/api/kpi/kpichk",this.form);this.form.n_kpiconm=t,this.form.f_kpichk=t.length?"Y":"N"},async save(){this.$refs.form.validate(),await this.$nextTick(),this.valid&&this.$refs.c_com.validate()&&this.$refs.i_id.validate()&&(this.$emit("onSave",this.form),this.init())}}},k=_,v=i("2877"),g=Object(v["a"])(k,l,c,!1,null,null,null),b=g.exports,y=function(){var t=this,e=t._self._c;return e("v-form",{ref:"form",on:{submit:function(e){return e.preventDefault(),t.onImage.apply(null,arguments)}}},[e("v-text-field",{attrs:{label:"사업장코드",readonly:""},model:{value:t.form.c_com,callback:function(e){t.$set(t.form,"c_com",e)},expression:"form.c_com"}}),e("v-file-input",{attrs:{label:"이미지",multiple:!1,accept:"image/jpg,image/png"},model:{value:t.form.t_image,callback:function(e){t.$set(t.form,"t_image",e)},expression:"form.t_image"}}),e("v-btn",{attrs:{type:"submit",block:"",color:"primary"}},[t._v("저 장")])],1)},x=[],w={name:"WorkSiteImage",props:{c_com:null},data(){return{form:{c_com:this.c_com,t_image:null}}},watch:{c_com(){this.form.c_com=this.c_com,this.form.t_image=""}},methods:{async onImage(){const t=new FormData,e=Object.keys(this.form);for(const s of e)t.append(s,this.form[s]);const i=await this.$axios.post("/api/system/siteImageSave",t);this.form.t_image="",this.form.c_com="",this.$emit("onSave",i)}}},$=w,C=Object(v["a"])($,y,x,!1,null,null,null),I=C.exports,S={components:{TooltipBtn:r["a"],EzDialog:n["a"],WorksiteForm:b,WorkSiteImage:I},name:"AdmWorksite",mounted(){this.init()},data(){return{headers:[{text:"사업장코드",value:"c_com",sortable:!1,align:"center",width:"100px"},{text:"사업장명",value:"n_com",sortable:!1},{text:"관리자성명",value:"n_name",sortable:!1,align:"center",width:"20%"},{text:"관리자ID",value:"i_id",sortable:!1,align:"center",width:"20%"},{text:"사업자번호",value:"i_company",sortable:!1,align:"center",width:"130px"},{text:"KPI 인증키",value:"i_kpikey",sortable:!1,align:"center",width:"130px"},{text:"장비모니터링주소",value:"t_monitor",sortable:!1,align:"center",width:"130px"},{text:"사용여부",value:"f_use",sortable:!1,align:"center",width:"100px"},{text:"코드초기화",value:"f_init",sortable:!1,align:"center",width:"100px"}],items:[],selected:[],item:{c_com:"",n_com:"",n_name:"",i_id:"",f_use:"",i_company:"",i_kpikey:"",f_kpichk:"",n_kpiconm:"",t_monitor:"",t_worklog:"",t_worksign:"",t_remark:""},isLoad:!1}},watch:{},computed:{siteImglog(){if(this.selected.t_worklog)return this.selected.t_worklog}},methods:{...Object(a["b"])("system",["duplicateCheck","duplicateDualCheck","insertWorksite","updateWorksite","iuSiteCodeinit","siteImageSave"]),async init(){this.fetchData()},async fetchData(){this.items=await this.$axios.get("/api/system/")},async showRowInfo(t,{item:e}){this.item=Object(m["deepCopy"])(e),this.$refs.dialog.open()},async showWorkSiteLog(t,{item:e}){this.selected!=e&&(this.selected=e)},async addWorkSite(t){this.isLoad=!0,this.item=null,this.$refs.dialog.open()},closeDialog(){this.isLoad=!1,this.item=null},async keyCheckCom(t){const e={field:"c_com",value:t};return await this.duplicateCheck(e)},async keyCheckId(t,e){const i={com:"c_com",aFiled:e,field:"i_id",value:t};return await this.duplicateDualCheck(i)},async save(t){if(this.isLoading=!0,this.item){await this.updateWorksite(t)}else{await this.insertWorksite(t)}this.isLoading=!1,this.$refs.dialog.close()},async clickInit(t){const e=await this.$ezNotify.confirm("<br>공통코드 초기화 하시겠습니까 ?<br>이전 자료는 삭제 처리.... ",""+t.n_com,{icon:"mdi-message-bulleted-off",width:400});if(!e)return;const i=await this.$ezNotify.confirm("초기화 실행 합니다. ",""+t.n_com,{icon:"mdi-message-bulleted-off",width:400});if(!i)return;const s=this.iuSiteCodeinit(t);s?this.$toast.info("공통코드 초기하 처리 하였습니다..."):this.$toast.error("실패...")},async clickLogImage(){this.$refs.dialog_log.open()},async saveimgage(t){t.length>0?(this.selected.t_worklog=t,this.$toast.info("저장 하였습니다. ")):this.$toast.error("실패..."),this.$refs.dialog_log.close()}}},D=S,L=Object(v["a"])(D,s,o,!1,null,null,null);e["default"]=L.exports},"8fac":function(t,e,i){"use strict";var s=function(){var t=this,e=t._self._c;return e("v-text-field",t._b({ref:"field",attrs:{value:t.value,maxlength:t.$attrs.counter,"error-messages":t.errMsg,"success-messages":t.successMsg},on:{input:t.onInput},scopedSlots:t._u([t.isCheck?null:{key:"append",fn:function(){return[e("v-tooltip",{attrs:{top:""},scopedSlots:t._u([{key:"activator",fn:function({on:i,attrs:s}){return[e("v-btn",t._g(t._b({attrs:{icon:"",small:"",tabindex:"-1",loading:t.loading},on:{click:t.check}},"v-btn",s,!1),i),[e("v-icon",[t._v("mdi-check")])],1)]}}],null,!1,1344435932)},[t._v(" "+t._s(t.$attrs.label)+" 중복검사 ")])]},proxy:!0}],null,!0)},"v-text-field",t.$attrs,!1))},o=[],a={name:"InputDuplicateDualCheck",model:{prop:"value",event:"input"},props:{value:String,cbCheck:{type:Function,default:null},origin:{type:String,default:""},aFiled:{type:String,default:""}},watch:{origin(){this.isCheck=!!this.origin||!this.cbCheck}},data(){return{isCheck:!!this.origin||!this.cbCheck,loading:!1,errMsg:"",successMsg:""}},computed:{isSend(){return!!this.cbCheck&&0===this.$refs.field.errorBucket.length}},mounted(){},methods:{onInput(t){this.isCheck=this.origin?this.origin===t:!this.cbCheck,this.errMsg="",this.successMsg="",this.$emit("input",t)},init(){this.errMsg="",this.successMsg=""},async check(){if(!this.isSend)return;this.loading=!0,this.errMsg="",this.successMsg="";const t=await this.cbCheck(this.value,this.aFiled);this.value?0==t.cnt?(this.successMsg=`사용 가능한 ${this.$attrs.label} 입니다.`,this.isCheck=!0):(this.errMsg=`중복된 ${this.$attrs.label} 입니다.`,this.isCheck=!1):this.successMsg="",this.loading=!1},validate(){return this.isCheck||(this.errMsg=this.$attrs.label+" 중복검사를 해주세요.",this.$refs.field.focus()),this.isCheck}}},r=a,n=i("2877"),l=Object(n["a"])(r,s,o,!1,null,null,null);e["a"]=l.exports},a2e4:function(t,e,i){"use strict";var s=function(){var t=this,e=t._self._c;return e("v-dialog",t._b({model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},"v-dialog",t.$attrs,!1),[e("v-card",[e("v-toolbar",[e("v-toolbar-title",[t._v(t._s(t.label))]),e("v-spacer"),t.obtn?e("v-btn",{attrs:{color:"primary",small:""},on:{click:t.btnClick}},[t._v(" "+t._s(t.obtn)+" ")]):t._e(),e("v-btn",{attrs:{icon:""},on:{click:t.close}},[e("v-icon",[t._v("mdi-close")])],1)],1),e("v-card-text",[t._t("default")],2)],1)],1)},o=[],a={name:"ezDialog",props:{label:{type:String,required:!0},obtn:{type:String}},data(){return{dialog:!1}},methods:{close(){this.dialog=!1,this.$emit("onClose")},open(){this.$emit("onOpen"),this.dialog=!0},btnClick(){this.dialog=!1,this.$emit("btnClick")}}},r=a,n=i("2877"),l=Object(n["a"])(r,s,o,!1,null,null,null);e["a"]=l.exports}}]);
//# sourceMappingURL=AdmWorksite.d64a3cef.js.map
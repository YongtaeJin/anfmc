(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["ShopArgeeMag"],{"3ad5":function(t,e,s){"use strict";s.r(e);var a=function(){var t,e=this,s=e._self._c;return s("v-container",{attrs:{fluid:""}},[s("v-toolbar",{attrs:{height:"40px","background-color":"primary",dark:""}},[s("v-toolbar-title",[e._v("사업협약서관리 :")]),s("v-col",{attrs:{sm:"3",md:"3"}},[s("v-select",{staticClass:"my-text-field no-padding",staticStyle:{"font-size":"0.8rem"},attrs:{items:e.shopList,"item-text":"n_shop","item-value":"i_shop",dense:""},on:{input:e.fetchData},model:{value:e.selectShop,callback:function(t){e.selectShop=t},expression:"selectShop"}})],1),s("v-spacer"),s("tooltip-btn",{attrs:{label:"조회"},on:{click:e.fetchData}},[s("v-icon",[e._v("mdi-magnify")])],1)],1),s("v-data-table",{staticClass:"elevation-1 text-no-wrap",attrs:{headers:e.headers,items:e.itemArgee,"single-select":"","item-key":"i_ser","items-per-page":-1,"hide-default-footer":"",height:e.iframeHeight},scopedSlots:e._u([{key:"item",fn:function({item:t}){return[s("tr",{staticClass:"center-align",class:{row_select:t===e.selected},on:{click:function(s){return e.selectItem(t)}}},[s("td",{attrs:{align:"left"},on:{dblclick:function(s){return e.showRowInfo(t)}}},[s("u",[e._v(e._s(t.n_company))])]),t.rnum>=1?s("td",{class:{green2:t.t1}},[e._v(" "+e._s(e.datachk(t.t1)))]):e._e(),t.rnum>=2?s("td",{class:{green2:t.t2}},[e._v(" "+e._s(e.datachk(t.t2)))]):e._e(),t.rnum>=3?s("td",{class:{green2:t.t3}},[e._v(" "+e._s(e.datachk(t.t3)))]):e._e(),t.rnum>=4?s("td",{class:{green2:t.t4}},[e._v(" "+e._s(e.datachk(t.t4)))]):e._e(),t.rnum>=5?s("td",{class:{green2:t.t5}},[e._v(" "+e._s(e.datachk(t.t5)))]):e._e(),t.rnum>=6?s("td",{class:{green2:t.t6}},[e._v(" "+e._s(e.datachk(t.t6)))]):e._e(),t.rnum>=7?s("td",{class:{green2:t.t7}},[e._v(" "+e._s(e.datachk(t.t7)))]):e._e(),t.rnum>=8?s("td",{class:{green2:t.t8}},[e._v(" "+e._s(e.datachk(t.t8)))]):e._e(),t.rnum>=9?s("td",{class:{green2:t.t9}},[e._v(" "+e._s(e.datachk(t.t9)))]):e._e(),t.rnum>=10?s("td",{class:{green2:t.t10}},[e._v(" "+e._s(e.datachk(t.t10)))]):e._e(),t.rnum>=11?s("td",{class:{green2:t.t11}},[e._v(" "+e._s(e.datachk(t.t11)))]):e._e(),t.rnum>=12?s("td",{class:{green2:t.t12}},[e._v(" "+e._s(e.datachk(t.t12)))]):e._e(),t.rnum>=13?s("td",{class:{green2:t.t13}},[e._v(" "+e._s(e.datachk(t.t13)))]):e._e(),t.rnum>=14?s("td",{class:{green2:t.t14}},[e._v(" "+e._s(e.datachk(t.t14)))]):e._e(),t.rnum>=15?s("td",{class:{green2:t.t15}},[e._v(" "+e._s(e.datachk(t.t15)))]):e._e(),t.rnum>=16?s("td",{class:{green2:t.t16}},[e._v(" "+e._s(e.datachk(t.t16)))]):e._e(),t.rnum>=17?s("td",{class:{green2:t.t17}},[e._v(" "+e._s(e.datachk(t.t17)))]):e._e(),t.rnum>=18?s("td",{class:{green2:t.t18}},[e._v(" "+e._s(e.datachk(t.t18)))]):e._e(),t.rnum>=19?s("td",{class:{green2:t.t19}},[e._v(" "+e._s(e.datachk(t.t19)))]):e._e(),t.rnum>=20?s("td",{class:{green2:t.t20}},[e._v(" "+e._s(e.datachk(t.t20)))]):e._e(),s("td",{class:{greencol:t.f_argeechk},on:{dblclick:function(s){return e.f_argeechk(t)}}},[s("u",[e._v(e._s(e.argeechk(t.f_argeechk)))])])])]}}])}),s("ez-dialog",{ref:"dialog_arg",attrs:{label:"협약서 서류 확인","max-width":"800",color:"primary",persistent:""}},[s("shop-input-mag-file-form",{attrs:{fileLists:e.fileAddsC,companyName:null===(t=e.selected)||void 0===t?void 0:t.n_company},on:{process:e.saveDocProcess,mailSend:e.mailSend}})],1),s("tiptab-mail",{ref:"dialog",attrs:{label:"메일발송",body_content:this.mailinfo.body,mail_title:this.mailinfo.title,itemInput:this.itemInput,"max-width":"900","max-height":"1300",persistent:""},on:{onSend:e.sendMail}}),s("ez-dialog-2",{ref:"ez_wait",attrs:{label:"처리중","max-width":"200",persistent:"",color:"primary"}})],1)},i=[],n=(s("14d9"),s("64f2")),o=s("414b"),r=s("a2e4"),l=s("0e60"),c=s("762b"),h=s("a01d"),d={components:{TooltipBtn:o["a"],EzDialog:r["a"],EzDialog2:l["a"],ShopInputMagFileForm:c["a"],TiptabMail:h["a"]},name:"ShopArgeeMag",data(){return{iframeHeight:500,selectShop:null,shopList:[],selected:[],headers:[],itemArgee:[],fileAddsC:[],itemInput:null,mailinfo:{title:"",to_email:"",cc_email:"",body:""}}},beforeCreate(){var t;null!==(t=this.$store.state.user.member)&&void 0!==t&&t.c_com||this.$router.push("/").catch(()=>{this.$toast.error("잘못된 접급 입니다.")})},mounted(){window.addEventListener("resize",this.adjustIframeHeight),this.adjustIframeHeight(),this.init(),this.fetchData()},beforeDestroy(){window.removeEventListener("resize",this.adjustIframeHeight)},methods:{adjustIframeHeight(){const t=window.innerHeight;this.iframeHeight=t-200},async init(){this.shopList=await this.$axios.get("/api/shopinfo/getShopList"),this.shopList.length&&(this.selectShop=this.shopList[0].i_shop,await this.fetchData())},async fetchData(){if(this.rnum=1,!this.selectShop)return void(this.shopList=[]);const t={i_shop:this.selectShop},e={};if(this.headers.splice(0),e.text="업체명",e.value="n_company",e.sortable=!1,e.align="center",this.headers.push({...e}),this.itemArgee=await this.$axios.post("/api/shopinfo/getShopArgeeMag",t),this.itemArgee.length){this.rnum=this.itemArgee[0].rnum;for(let t=0;t<Object.keys(this.itemArgee[0]).length;t++){let s=Object.keys(this.itemArgee[0])[t],a=this.itemArgee[0][s];"h"==s[0]&&this.rnum>=Object(n["extractNumber"])(s)&&(e.text=a,e.value="t"+Object(n["extractNumber"])(s),e.sortable=!1,e.align="center",e.width="60px",this.headers.push({...e}))}e.text="확인",e.value="f_argeechk",e.sortable=!1,e.align="center",this.headers.push({...e})}},selectItem(t){this.selected=t},datachk(t){let e="";return e=t?"완료":"미완료",e},argeechk(t){return"Y"==t?"확인":"미확인"},async f_argeechk(t){const e=await this.$ezNotify.confirm("처리 하시겠습니까  ?","협약서");if(e)if("Y"==t.f_argeechk)t.f_argeechk="N";else{t.f_argeechk="Y";await this.$axios.post("/api/shopinfo/ShopInputMagArgeeChk",t)}},async showRowInfo(t){this.n_company=t.n_company;const e=t;e.f_gubun="3",this.itemInput=await this.$axios.post("/api/shopinfo/getShopInputMag1",t),this.fileAddsC=await this.$axios.post("/api/shopinfo/getShopInputMag2",e),this.$refs.dialog_arg.open()},async saveDocProcess(t){for(let e in t)if("1"==t[e].f_edit){this.$axios.post("/api/shopinfo/ShopInputMag2Save",t[e])}},async mailSend(){let t="<p>상기 제목 관련 하여 아래와 같이 첨부 서류 확인 결과 전달 드립니다.</p><p>";this.mailinfo.title="스마트공방 협약서 서류 확인 안내",t+="스마트공방 협약서 서류 확인 안내</p></p>",this.fileAddsC.forEach(e=>{let s="Y"==e.f_noact?"접수":"N"==e.f_noact?"반려":"I"==e.f_noact||"R"==e.f_noact?"검토":"미등록";t+=`<p>${"Y"==e.f_noact?"":'<span style="color:red"'}>${e.n_filename} : 서류${s}${"Y"==e.f_noact?"":"</span>"}</p>`}),t+="<p>반려된 첨부서류에 대해서 재 등록 부탁 드립니다.</p>",t+="<p></p>감사 합니다.",this.mailinfo.body=t,this.$refs.dialog.open()},async sendMail(t,e,s,a){this.$refs.ez_wait.open(),this.mailinfo.title=t,this.mailinfo.to_email=e,this.mailinfo.cc_email=s,this.mailinfo.body=a;const i=await this.$axios.post("/api/shopinfo/postMailSend",this.mailinfo);this.$refs.ez_wait.close(),"ok"==i&&(this.$ezNotify.alert("정상적으로 메일 발송 하였습니다..... ","성공"),this.$refs.dialog.close())}}},p=d,_=s("2877"),m=Object(_["a"])(p,a,i,!1,null,null,null);e["default"]=m.exports},a2e4:function(t,e,s){"use strict";var a=function(){var t=this,e=t._self._c;return e("v-dialog",t._b({model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},"v-dialog",t.$attrs,!1),[e("v-card",[e("v-toolbar",[e("v-toolbar-title",[t._v(t._s(t.label))]),e("v-spacer"),t.obtn?e("v-btn",{attrs:{color:"primary",small:""},on:{click:t.btnClick}},[t._v(" "+t._s(t.obtn)+" ")]):t._e(),e("v-btn",{attrs:{icon:""},on:{click:t.close}},[e("v-icon",[t._v("mdi-close")])],1)],1),e("v-card-text",[t._t("default")],2)],1)],1)},i=[],n={name:"ezDialog",props:{label:{type:String,required:!0},obtn:{type:String}},data(){return{dialog:!1}},methods:{close(){this.dialog=!1,this.$emit("onClose")},open(){this.$emit("onOpen"),this.dialog=!0},btnClick(){this.dialog=!1,this.$emit("btnClick")}}},o=n,r=s("2877"),l=Object(r["a"])(o,a,i,!1,null,null,null);e["a"]=l.exports}}]);
//# sourceMappingURL=ShopArgeeMag.333378b0.js.map
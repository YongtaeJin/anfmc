(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Salesestimate"],{cc66:function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t._self._c;return e("v-container",{attrs:{fluid:""}},[e("v-toolbar",{attrs:{height:"40px","background-color":"primary",dark:""}},[e("v-toolbar-title",[t._v("견적 관리")]),e("v-spacer"),e("tooltip-btn",{attrs:{label:"견적 조회"},on:{click:t.select}},[e("v-icon",[t._v("mdi-magnify")])],1),e("tooltip-btn",{attrs:{label:"견적 작성"},on:{click:t.addEstimates}},[e("v-icon",[t._v("mdi-plus")])],1),e("tooltip-btn",{attrs:{label:"견적 삭제"},on:{click:t.delEstimates}},[e("v-icon",[t._v("mdi-minus")])],1),e("tooltip-btn",{attrs:{label:"견적 저장"},on:{click:t.saveEstimates}},[e("v-icon",[t._v("mdi-content-save-outline")])],1),e("tooltip-btn",{attrs:{label:"견적 출력"},on:{click:t.printEstimates}},[e("v-icon",[t._v("mdi-printer")])],1)],1),e("v-card",{staticClass:"my-card"},[e("v-row",{staticClass:"my-text-field",attrs:{"no-gutters":""}},[e("v-col",{attrs:{col:"12",sm:"1",md:"1"}},[e("v-text-field",{staticClass:"text-input-blue no-padding",attrs:{value:"견적기간",readonly:"",dense:"","hide-details":""}})],1),e("v-col",{attrs:{col:"12",sm:"2",md:"2"}},[e("input-date-3",{model:{value:t.form.sDate1,callback:function(e){t.$set(t.form,"sDate1",e)},expression:"form.sDate1"}})],1),e("v-col",{attrs:{col:"12",sm:"2",md:"2"}},[e("input-date-3",{model:{value:t.form.sDate2,callback:function(e){t.$set(t.form,"sDate2",e)},expression:"form.sDate2"}})],1),e("v-col",{attrs:{col:"12",sm:"1",md:"1"}},[e("v-text-field",{staticClass:"text-input-blue no-padding",attrs:{value:"고객사",readonly:"",dense:"","hide-details":""}})],1),e("v-col",{attrs:{col:"12",sm:"3",md:"3"}},[e("v-text-field",{staticClass:"text-input-blue no-padding",attrs:{dense:"","hide-details":""},model:{value:t.form.sVend,callback:function(e){t.$set(t.form,"sVend",e)},expression:"form.sVend"}})],1),e("v-col",{attrs:{col:"12",sm:"1",md:"1"}},[e("v-text-field",{staticClass:"text-input-blue no-padding",attrs:{value:"견적상태",readonly:"",dense:"","hide-details":""}})],1),e("v-col",{attrs:{col:"12",sm:"2",md:"2"}},[e("v-select",{staticClass:"my-text-field",attrs:{items:t.ESTI001,"item-text":"label","item-value":"value",dense:""},nativeOn:{keydown:function(e){return t.onKeyDownStatus.apply(null,arguments)}},model:{value:t.form.sStatus,callback:function(e){t.$set(t.form,"sStatus",e)},expression:"form.sStatus"}})],1)],1),e("v-row",{staticClass:"my-text-field",attrs:{"no-gutters":""}},[e("v-col",{attrs:{col:"12",sm:"1",md:"1"}},[e("v-text-field",{staticClass:"text-input-blue no-padding",attrs:{value:"견적번호",readonly:"",dense:"","hide-details":""}})],1),e("v-col",{attrs:{col:"12",sm:"4",md:"4"}},[e("v-text-field",{staticClass:"my-text-field no-padding",attrs:{dense:"","hide-details":""},model:{value:t.form.sEsimate,callback:function(e){t.$set(t.form,"sEsimate",e)},expression:"form.sEsimate"}})],1)],1),e("v-row",{staticClass:"my-text-fieldend",attrs:{"no-gutters":""}},[e("v-col")],1)],1),e("v-row",[e("v-col",{attrs:{col:"12",sm:"4",md:"4"}},[e("v-data-table",{ref:"table",staticClass:"elevation-1 text-no-wrap",attrs:{headers:t.master,items:t.estimates,"item-key":"i_ser","single-select":"","items-per-page":-1,"hide-default-footer":"","footer-props":{"items-per-page-options":[10,20,30,40,50,100,-1]},height:t.iframeHeight},on:{"click:row":t.rowSelectMaster},scopedSlots:t._u([{key:"item.f_status",fn:function({item:e}){return[t._v(" "+t._s(t.getStatus(e.f_status))+" ")]}},{key:"item.a_estamt",fn:function({item:i}){return[e("div",{staticClass:"right2-align"},[t._v(t._s(t.comma(i.a_estamt)))])]}}],null,!0),model:{value:t.selectedM,callback:function(e){t.selectedM=e},expression:"selectedM"}})],1),e("v-col",{attrs:{col:"12",sm:"8",md:"8"}},[e("v-form",{ref:"form",attrs:{"lazy-validation":""},on:{submit:function(e){return e.preventDefault(),t.save.apply(null,arguments)}},model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[e("v-card",{attrs:{color:"grey lighten-4"}},[e("v-row",{staticClass:"my-text-field",attrs:{"no-gutters":""}},[e("v-col",{attrs:{col:"8",sm:"1",md:"1"}},[e("v-text-field",{staticClass:"text-input-redbrg no-padding",attrs:{value:"견적번호",readonly:"",dense:"","hide-details":""}})],1),e("v-col",{attrs:{col:"8",sm:"2",md:"2"}},[e("v-text-field",{staticClass:"no-padding",attrs:{readonly:!t.edit,dense:"","hide-details":""},on:{input:t.onChangeEstno},model:{value:t.estimate.i_estno,callback:function(e){t.$set(t.estimate,"i_estno",e)},expression:"estimate.i_estno"}})],1),e("v-col",{attrs:{col:"8",sm:"1",md:"1"}},[e("v-text-field",{staticClass:"text-input-redbrg no-padding",attrs:{value:"견적상태",readonly:"",dense:"","hide-details":""}})],1),e("v-col",{attrs:{col:"8",sm:"2",md:"2"}},[t.editStatus?e("v-select",{staticClass:"my-text-field no-padding",attrs:{items:t.ESTI001,"item-text":"label","item-value":"value",rules:[t.rules.require({label:"견적상태"})],readonly:!t.editStatus,dense:""},on:{input:t.onChangeMaster},model:{value:t.estimate.f_status,callback:function(e){t.$set(t.estimate,"f_status",e)},expression:"estimate.f_status"}}):e("v-text-field",{staticClass:"no-padding",attrs:{value:t.getStatus(t.estimate.f_status),readonly:"",dense:"","hide-details":""}})],1)],1),e("v-row",{staticClass:"my-text-field",attrs:{"no-gutters":""}},[e("v-col",{attrs:{col:"8",sm:"1",md:"1"}},[e("v-text-field",{staticClass:"text-input-redbrg no-padding",attrs:{value:"견적명",readonly:"",dense:"","hide-details":""}})],1),e("v-col",{attrs:{col:"8",sm:"6",md:"6"}},[e("v-text-field",{staticClass:"no-padding",attrs:{readonly:!t.edit,dense:"","hide-details":""},on:{input:t.onChangeMaster},model:{value:t.estimate.n_estnm,callback:function(e){t.$set(t.estimate,"n_estnm",e)},expression:"estimate.n_estnm"}})],1)],1),e("v-row",{staticClass:"my-text-field",attrs:{"no-gutters":""}},[e("v-col",{attrs:{col:"8",sm:"1",md:"1"}},[e("v-text-field",{staticClass:"text-input-bluebrg no-padding",attrs:{value:"고객사",readonly:"",dense:"","hide-details":""}})],1),e("v-col",{attrs:{col:"8",sm:"4",md:"4"}},[t.edit?e("v-text-field",{staticClass:"no-padding",attrs:{readonly:"",dense:"","hide-details":""},scopedSlots:t._u([{key:"append",fn:function(){return[e("div",{staticClass:"no-padding"},[e("v-btn",{attrs:{icon:"","x-small":"",tabindex:"-1"},on:{click:t.clickVend}},[e("v-icon",[t._v(" mdi-dialpad ")])],1)],1)]},proxy:!0}],null,!1,3843805477),model:{value:t.estimate.n_vend,callback:function(e){t.$set(t.estimate,"n_vend",e)},expression:"estimate.n_vend"}}):e("v-text-field",{staticClass:"no-padding",attrs:{readonly:"",dense:"","hide-details":""},on:{input:t.onChangeMaster},model:{value:t.estimate.n_vend,callback:function(e){t.$set(t.estimate,"n_vend",e)},expression:"estimate.n_vend"}})],1),e("v-col",{attrs:{col:"8",sm:"1",md:"1"}})],1),e("v-row",{staticClass:"my-text-field",attrs:{"no-gutters":""}},[e("v-col",{attrs:{col:"8",sm:"1",md:"1"}},[e("v-text-field",{staticClass:"text-input-bluebrg no-padding",attrs:{value:"견적일",readonly:"",dense:"","hide-details":""}})],1),e("v-col",{attrs:{col:"8",sm:"2",md:"2"}},[e("input-date-3",{attrs:{readonly:!t.edit,rules:t.rules.date({required:!1})},on:{input:t.onChangeMaster},model:{value:t.estimate.s_date,callback:function(e){t.$set(t.estimate,"s_date",e)},expression:"estimate.s_date"}})],1),e("v-col",{attrs:{col:"8",sm:"1",md:"1"}},[e("v-text-field",{staticClass:"text-input-bluebrg no-padding",attrs:{value:"유효일",readonly:"",dense:"","hide-details":""}})],1),e("v-col",{attrs:{col:"8",sm:"2",md:"2"}},[e("input-date-3",{attrs:{readonly:!t.edit,rules:t.rules.date({required:!1})},on:{input:t.onChangeMaster},model:{value:t.estimate.s_date2,callback:function(e){t.$set(t.estimate,"s_date2",e)},expression:"estimate.s_date2"}})],1),e("v-col",{attrs:{col:"8",sm:"1",md:"1"}},[e("v-text-field",{staticClass:"text-input-bluebrg no-padding",attrs:{value:"납기일",readonly:"",dense:"","hide-details":""}})],1),e("v-col",{attrs:{col:"8",sm:"2",md:"2"}},[e("input-date-3",{attrs:{readonly:!t.edit,rules:t.rules.date({required:!1})},on:{input:t.onChangeMasterDate},model:{value:t.estimate.s_date3,callback:function(e){t.$set(t.estimate,"s_date3",e)},expression:"estimate.s_date3"}})],1)],1),e("v-row",{staticClass:"my-text-field",attrs:{"no-gutters":""}},[e("v-col",{attrs:{col:"8",sm:"1",md:"1"}},[e("v-text-field",{staticClass:"text-input-bluebrg no-padding",attrs:{value:"수신자",readonly:"",dense:"","hide-details":""}})],1),e("v-col",{attrs:{col:"8",sm:"2",md:"2"}},[e("v-text-field",{staticClass:"no-padding",attrs:{readonly:!t.edit,dense:"","hide-details":""},on:{input:t.onChangeMaster},model:{value:t.estimate.n_rname,callback:function(e){t.$set(t.estimate,"n_rname",e)},expression:"estimate.n_rname"}})],1),e("v-col",{attrs:{col:"8",sm:"1",md:"1"}},[e("v-text-field",{staticClass:"text-input-bluebrg no-padding",attrs:{value:"연락처",readonly:"",dense:"","hide-details":""}})],1),e("v-col",{attrs:{col:"8",sm:"2",md:"2"}},[e("v-text-field",{staticClass:"no-padding",attrs:{readonly:!t.edit,placeholder:"전화번호",dense:"","hide-details":""},on:{input:t.onChangeMaster},model:{value:t.estimate.t_rtel,callback:function(e){t.$set(t.estimate,"t_rtel",e)},expression:"estimate.t_rtel"}})],1),e("v-col",{attrs:{col:"8",sm:"1",md:"1"}},[e("v-text-field",{staticClass:"text-input-bluebrg no-padding",attrs:{value:"E-Mail",readonly:"",dense:"","hide-details":""}})],1),e("v-col",{attrs:{col:"8",sm:"3",md:"3"}},[e("v-text-field",{staticClass:"no-padding",attrs:{readonly:!t.edit,placeholder:"E-Mail",dense:"","hide-details":""},on:{input:t.onChangeMaster},model:{value:t.estimate.t_remail,callback:function(e){t.$set(t.estimate,"t_remail",e)},expression:"estimate.t_remail"}})],1)],1),e("v-row",{staticClass:"my-text-field",attrs:{"no-gutters":""}},[e("v-col",{attrs:{col:"8",sm:"1",md:"1"}},[e("v-text-field",{staticClass:"text-input-bluebrg no-padding",attrs:{value:"담당자",readonly:"",dense:"","hide-details":""}})],1),e("v-col",{attrs:{col:"8",sm:"2",md:"2"}},[e("v-text-field",{staticClass:"no-padding",attrs:{readonly:!t.edit,dense:"","hide-details":""},on:{input:t.onChangeMaster},model:{value:t.estimate.n_magname,callback:function(e){t.$set(t.estimate,"n_magname",e)},expression:"estimate.n_magname"}})],1),e("v-col",{attrs:{col:"8",sm:"1",md:"1"}},[e("v-text-field",{staticClass:"text-input-bluebrg no-padding",attrs:{value:"연락처",readonly:"",dense:"","hide-details":""}})],1),e("v-col",{attrs:{col:"8",sm:"2",md:"2"}},[e("v-text-field",{staticClass:"no-padding",attrs:{readonly:!t.edit,placeholder:"담당자 연락처",dense:"","hide-details":""},on:{input:t.onChangeMaster},model:{value:t.estimate.t_magtel,callback:function(e){t.$set(t.estimate,"t_magtel",e)},expression:"estimate.t_magtel"}})],1),e("v-col",{attrs:{col:"8",sm:"1",md:"1"}},[e("v-text-field",{staticClass:"text-input-redbrg no-padding",attrs:{value:"견적금액",readonly:"",dense:"","hide-details":""}})],1),e("v-col",{attrs:{col:"8",sm:"2",md:"2"}},[e("v-text-field",{staticClass:"text-input-redbrg inputPrice no-padding",attrs:{value:t.comma(t.estimate.a_estamt)+"원",readonly:"",dense:"","hide-details":""}})],1)],1),e("v-row",{staticClass:"my-text-field",attrs:{"no-gutters":""}},[e("v-col",{attrs:{col:"8",sm:"1",md:"1"}},[e("v-text-field",{staticClass:"text-input-bluebrg no-padding",attrs:{value:"메모",readonly:"",dense:"","hide-details":""}})],1),e("v-col",{attrs:{col:"12",sm:"8",md:"8"}},[e("v-text-field",{staticClass:"no-padding",attrs:{dense:"","hide-details":""},model:{value:t.estimate.t_remark,callback:function(e){t.$set(t.estimate,"t_remark",e)},expression:"estimate.t_remark"}})],1)],1),e("v-row",{staticClass:"my-text-fieldend",attrs:{"no-gutters":""}},[e("v-col")],1)],1)],1),e("v-toolbar",{attrs:{height:"35px",color:"accent"}},[e("v-toolbar-title",[t._v("견적 품목 List")]),e("v-spacer"),e("tooltip-btn",{attrs:{label:"추가",fab:"","x-small":""},on:{click:t.addDetail}},[e("v-icon",[t._v("mdi-plus")])],1),e("tooltip-btn",{attrs:{label:"삭제",fab:"","x-small":""},on:{click:t.delDetail}},[e("v-icon",[t._v("mdi-minus")])],1)],1),e("v-form",{ref:"form2",attrs:{"lazy-validation":""},model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[e("v-data-table",{staticClass:"elevation-1 text-no-wrap",attrs:{headers:t.detail,items:t.itmelitFilter,"item-key":"i_serno","single-select":"","items-per-page":-1,"hide-default-footer":"","footer-props":{"items-per-page-options":[10,20,30,40,50,100,-1]},"item-class":t.row_classes,height:t.iframeHeight-230},on:{"click:row":t.rowSelectDetail},scopedSlots:t._u([{key:"item.s_sort",fn:function({item:i}){return[t.edit&&i.i_serno===t.itmelit.i_serno?e("input-number",{attrs:{maxlength:2},on:{input:t.onChangeDetail},model:{value:i.s_sort,callback:function(e){t.$set(i,"s_sort",e)},expression:"item.s_sort"}}):e("span",[t._v(t._s(i.s_sort))])]}},{key:"item.n_item",fn:function({item:i}){return[t.edit&&i.i_serno===t.itmelit.i_serno?e("v-text-field",{staticClass:"my-text-field no-padding",attrs:{"hide-details":"",dense:"","single-line":"",readonly:""},scopedSlots:t._u([{key:"append",fn:function(){return[e("v-btn",{attrs:{icon:"","x-small":"",tabindex:"-1"},on:{click:t.clickItem}},[e("v-icon",[t._v(" mdi-dialpad ")])],1)]},proxy:!0}],null,!0),model:{value:i.n_item,callback:function(e){t.$set(i,"n_item",e)},expression:"item.n_item"}}):e("span",[t._v(t._s(i.n_item))])]}},{key:"item.m_cnt",fn:function({item:i}){return[t.edit&&i.i_serno===t.itmelit.i_serno?e("input-amt",{on:{input:t.onChangeAmt},model:{value:i.m_cnt,callback:function(e){t.$set(i,"m_cnt",e)},expression:"item.m_cnt"}}):e("span",[t._v(t._s(t.comma(i.m_cnt)))])]}},{key:"item.a_unit",fn:function({item:i}){return[t.edit&&i.i_serno===t.itmelit.i_serno?e("input-amt",{on:{input:t.onChangeAmt},model:{value:i.a_unit,callback:function(e){t.$set(i,"a_unit",e)},expression:"item.a_unit"}}):e("span",[e("div",{staticClass:"right2-align"},[t._v(t._s(t.comma(i.a_unit)))])])]}},{key:"item.a_amt",fn:function({item:i}){return[t.edit&&i.i_serno===t.itmelit.i_serno?e("input-amt",{on:{input:t.onChangeAmt2},model:{value:i.a_amt,callback:function(e){t.$set(i,"a_amt",e)},expression:"item.a_amt"}}):e("span",[e("div",{staticClass:"right2-align"},[t._v(t._s(t.comma(i.a_amt)))])])]}},{key:"item.s_duedate",fn:function({item:i}){return[t.edit&&i.i_serno===t.itmelit.i_serno?e("input-date-2",{attrs:{rules:t.rules.date({required:!1})},on:{input:t.onChangeDetail},model:{value:i.s_duedate,callback:function(e){t.$set(i,"s_duedate",e)},expression:"item.s_duedate"}}):e("span",[t._v(t._s(i.s_duedate))])]}},{key:"item.t_remark",fn:function({item:i}){return[t.edit&&i.i_serno===t.itmelit.i_serno?e("v-text-field",{staticClass:"my-text-field no-padding",attrs:{dense:"","hide-details":""},on:{input:t.onChangeDetail},model:{value:i.t_remark,callback:function(e){t.$set(i,"t_remark",e)},expression:"item.t_remark"}}):e("span",[e("div",{staticClass:"left-align"},[t._v(t._s(i.t_remark))])])]}}],null,!0),model:{value:t.selectedD,callback:function(e){t.selectedD=e},expression:"selectedD"}})],1)],1)],1),e("ez-dialog",{ref:"dialog_Item",attrs:{label:"항목/품목",persistent:"",width:"460px"},on:{onClose:t.close_item}},[e("item-pop",{on:{onSelect:t.selectItem}})],1),e("ez-dialog",{ref:"dialog_Vend",attrs:{label:"거래처",persistent:"",width:"460px"},on:{onClose:t.close_item}},[e("vend-pop",{on:{onSelect:t.selectVend}})],1)],1)},a=[],l=(i("14d9"),i("4328")),n=i.n(l),o=i("8baf"),d=(i("0da4"),i("2f62")),r=i("12e3"),m=i("64f2"),c=i("248f"),u=i.n(c),h=i("a2e4"),_=i("414b"),f=i("f3db"),v=i("6b39"),p=i("1c76"),g=i("121b"),x=i("3bcf"),b=i("c477"),y=i("816b"),C={components:{TooltipBtn:_["a"],EzDialog:h["a"],InputDate2:f["a"],InputDate3:v["a"],ItemPop:x["a"],InputAmt:p["a"],InputNumber:g["a"],VendPop:b["a"]},name:"Salesestimate",mounted(){window.addEventListener("resize",this.adjustIframeHeight),this.adjustIframeHeight(),this.init()},beforeDestroy(){window.removeEventListener("resize",this.adjustIframeHeight)},data(){return{ESTI001:r["a"],valid:!0,iframeHeight:500,master:[{text:"견적번호",value:"i_estno",sortable:!1,align:"center",width:"65px"},{text:"상태",value:"f_status",sortable:!1,align:"center",width:"25px"},{text:"고객사",value:"n_vend",sortable:!1,align:"center",width:"75px"},{text:"견적금액",value:"a_estamt",sortable:!1,align:"center",width:"65px"}],estimates:[],estimate:[],selectedM:[],detail:[{text:"No",value:"s_sort",sortable:!1,align:"center",width:"35px"},{text:"항목(품목)",value:"n_item",sortable:!1,align:"center",width:"130px"},{text:"규격(사양)",value:"t_size",sortable:!1,align:"center",width:"100px"},{text:"단위",value:"i_unit",sortable:!1,align:"center",width:"90px"},{text:"수량",value:"m_cnt",sortable:!1,align:"center",width:"60px"},{text:"단가",value:"a_unit",sortable:!1,align:"center",width:"90px"},{text:"금액",value:"a_amt",sortable:!1,align:"center",width:"90px"},{text:"납기일",value:"s_duedate",sortable:!1,align:"center",width:"90px"},{text:"비고",value:"t_remark",sortable:!1,align:"center",width:"90px"}],itmelits:[],itmelit:[],itmelitFilter:[],selectedD:[],form:{sDate1:"",sDate2:"",sEsimate:"",sVend:"",sStatus:""},estDayFt:15,comImageLog:""}},watch:{estimate(){this.$refs.form.resetValidation()}},computed:{rules:()=>u.a,getMaxNo(){const t=Math.max(...this.itmelitFilter.map(t=>t.s_sort));return isFinite(t)?t:0},edit(){return void 0!=this.estimate.i_ser&&"A"!=this.estimate.f_status&&("S"!=this.estimate.f_status||"1"===this.estimate.f_edit)},editStatus(){return void 0!=this.estimate.i_ser&&("A"!=this.estimate.f_status||"0"!=this.estimate.f_editold||"1"===this.estimate.f_edit)},editDetail(){return!!this.edit&&void 0!=this.itmelit.i_serno},editJob(){return"1"==this.estimate.f_edit||(this.itmelitFilter.forEach(t=>{if("1"==t.f_edit||"2"==t.f_edit)return!0}),!1)},siteImglog(){return!!this.comImageLog.t_worklog&&this.comImageLog.t_worklog}},methods:{...Object(d["b"])("sales",["getSaleEstimate","iuSaleEstimate"]),adjustIframeHeight(){const t=window.innerHeight;this.iframeHeight=t-230},comma(t){return null!==t&&void 0!==t?String(Math.trunc(t)).replace(/\B(?=(\d{3})+(?!\d))/g,","):String(0).replace(/\B(?=(\d{3})+(?!\d))/g,",")},row_classes(t){if("2"==t.f_edit)return"orange"},onKeyDownStatus(t){46===t.keyCode&&(this.form.sStatus="")},async init(){this.form.sDate1=Object(m["getDate"])(-100,1);var t=n.a.stringify({c_com:this.$store.state.user.member.c_com,c_gcode:"BUSINESS",c_code:"ESTIMATE01",col:"m_buf1"}),e=await this.$axios.get("/api/sales/getSaleEstimateInit?"+t);this.estDayFt=parseFloat(e[0].m_buf1),this.select(),this.comImageLog=await this.$axios.post("/api/system/getSiteImage")},async select(){this.selectedM=[],this.selectedD=[],this.estimate=[],this.itmelit=[],this.itmelitFilter=[],this.itmelits&&this.itmelits.splice(0),this.estimates&&this.estimates.splice(0),this.estimates=await this.$axios.post("/api/sales/getSaleEstimate",this.form),this.estimates.length>0&&(this.itmelits=await this.$axios.post("/api/sales/getSaleEstimateli",this.form))},rowSelectMaster:function(t,e){this.editJob||(e.select(!0),this.estimate=t,this.rowFilter(t))},rowFilter(t){this.itmelitFilter=this.itmelits.filter(e=>e.i_ser==t.i_ser).map(t=>({...t}))},async addEstimates(){if(this.editJob)return void await this.$ezNotify.alert("</br>수정내용이 존재 합니다. </br>저장 후 작업가능 합니다. ","견적수정",{icon:"mdi-message-bulleted-off",width:400});const t=Date.now();this.selectedM=[],this.estimate={c_com:this.$store.state.user.member.c_com,i_ser:t,f_status:"I",s_date:Object(m["getDate"])(),s_date2:Object(m["getDate"])(this.estDayFt),f_use:"Y",f_edit:"1",f_editold:"1"};this.estimates.push(this.estimate);this.selectedM.push(this.estimate),this.rowFilter(this.estimate)},async delEstimates(){if(!this.edit)return void await this.$ezNotify.alert("견적서 작성상태만 삭제 가능 합니다.","삭제불가",{icon:"mdi-message-bulleted-off",width:250});if("1"!=this.estimate.f_editold){const t=await this.$ezNotify.confirm("선택한 견적서를 삭제 하시겠습니까 ?","삭제",{icon:"mdi-message-bulleted-off",width:350});if(!t)return;await this.$axios.delete(`/api/sales/delSaleEstimate/${this.estimate.c_com}/${this.estimate.i_ser}`)}this.itmelitFilter=[];const t=this.estimates.indexOf(this.estimate);t>=0&&this.estimates.splice(t,1),this.estimate=[],this.$toast.info("삭제 하였습니다.")},async saveEstimates(){if(!this.edit&&"0"==this.estimate.f_edit)return;if(null==this.estimate.i_estno)return void this.$toast.error("견적번호 입력 필수 입니다.");const t=Object.assign({},this.estimate,this.itmelitFilter),e=await this.iuSaleEstimate(t);for(let i=this.itmelitFilter.length-1;i>=0;i--)"2"==this.itmelitFilter[i].f_edit&&this.itmelitFilter.splice(i,1);if(0==e)this.itmelitFilter.forEach(t=>{t.f_edit="0",t.f_editold="0"}),this.estimate.f_edit="0",this.estimate.f_editold="0",this.$toast.info("저장 하였습니다.");else{e>0&&(this.estimate.f_edit="0",this.estimate.f_editold="0");for(let t=0;t<e-1;t++)this.itmelitFilter[t].f_edit="0",this.itmelitFilter[t].f_editold="0";await this.$ezNotify.alert("저장 중 오류가 발생 하였습니다...","오류",{icon:"mdi-message-bulleted"})}},async printEstimates(){if(void 0==this.estimate.i_ser)return;if(this.editJob)return void await this.$ezNotify.alert("</br>수정내용이 존재 합니다. </br>저장 후 작업가능 합니다. ","견적수정",{icon:"mdi-message-bulleted-off",width:400});let t=n.a.stringify({c_com:this.$store.state.user.member.c_com});const e=await this.$axios.get("/api/system/getCompany?"+t);t=n.a.stringify({c_com:this.$store.state.user.member.c_com,c_vend:this.estimate.c_vend});const i=await this.$axios.get("/api/basejob/getVendInfo?"+t),s=new o["default"]("p","mm","a4");if(this.siteImglog){const t=new Image;t.src=this.siteImglog,s.addImage(t,"JPEG",150,30,50,20)}s.addFileToVFS("malgun.ttf",y["a"]),s.addFont("malgun.ttf","malgun","normal"),s.setFont("malgun"),s.setFontSize(30),s.text("견  적  서",80,30),s.setFontSize(9),s.setLineWidth(.1),s.rect(10,50,190,230),this.doctext(s,Object(m["dateToKorean"])(this.estimate.s_date),10,55,7,80,1),s.setFontSize(15),this.doctext(s,(i.length>0?i[0].n_compnay:this.estimate.n_vend)+" 귀하",10,75,7,80,1),s.setFontSize(9),this.doctext(s,"아래와 같이 견적합니다",10,85,7,80,1),s.rect(90,50,10,35),s.text(93,60,"공"),s.text(93,68,"급"),s.text(93,77,"자"),s.rect(100,50,16,35),s.rect(100,50,100,7),this.doctext(s,"등록번호",105,56,7,7,1),this.doctext(s,e[0].c1,116,56,7,84,1),s.rect(100,57,100,7),this.doctext(s,"상 호 명",105,63,7,7,1),this.doctext(s,e[0].c2,116,63,7,33,1),s.rect(150,57,16,7),this.doctext(s,"대 표 자",155,63,7,7,1),this.doctext(s,e[0].c3,167,63,7,33,1),s.rect(100,64,100,7),this.doctext(s,"주    소",105,70,7,7,1),this.doctext(s,e[0].c4,116,70,7,84,1),s.rect(100,71,100,7),this.doctext(s,"업    태",105,77,7,7,1),this.doctext(s,e[0].c5,116,77,7,33,1),s.rect(150,71,16,7),this.doctext(s,"업    종",155,77,7,7,1),this.doctext(s,e[0].c6,167,77,7,33,1),s.rect(100,78,100,7),this.doctext(s,"전화번호",105,84,7,7,1),this.doctext(s,e[0].c7,116,84,7,33,1),s.rect(150,78,16,7),this.doctext(s,"FAX번호",155,84,7,7,1),this.doctext(s,e[0].c8,167,84,7,33,1),s.rect(10,85,190,7),s.text(32,90,` 견적금액 : 일금 ${Object(m["numberToKorean"])(this.estimate.a_estamt)}(￦${Object(m["amtToKorean"])(this.estimate.a_estamt)})원정 (부가세별도)`);for(let n=0;n<23;n++)0==n||22==n?(s.setFillColor(192,192,192),s.rect(10,92+7*n,190,7,"FD"),s.setFillColor(255,255,255)):s.rect(10,92+7*n,190,7);s.line(16,92,16,253),s.text(11,97,"No"),s.line(60,92,60,253),s.text(35,97,"품명"),s.line(100,92,100,253),s.text(75,97,"규격"),s.line(120,92,120,253),s.text(106,97,"단위"),s.line(130,92,130,253),s.text(122,97,"수량"),s.line(150,92,150,253),s.text(137,97,"단가"),s.line(172,92,172,253),s.text(158,97,"금액"),s.text(184,97,"비고");let a=0,l=0;this.itmelitFilter.forEach((t,e)=>{a=91+7*(e+2),this.doctext(s,(e+1).toString(),10,a,7,6,1),this.doctext(s,t.n_item,16,a,7,6,0),this.doctext(s,t.t_size,60,a,7,6,0),this.doctext(s,t.i_unit,100,a,7,20,1),this.doctext(s,t.m_cnt.toString(),120,a,7,10,1),this.doctext(s,this.comma(t.a_unit),130,a,7,20,2),this.doctext(s,this.comma(t.a_amt),150,a,7,22,2),this.doctext(s,t.t_remark,172,a,7,28,0),t.a_amt&&(l+=1*t.a_amt)}),a=91+7*(this.itmelitFilter.length+2),this.doctext(s,"- 이 하 여 백 -",60,a,7,40,1),s.setFontSize(10),a=252,this.doctext(s,"합 계",100,a,7,20,1),this.doctext(s,this.comma(l),150,a,7,22,2),s.setFontSize(9),a+=91,s.text(12,260,`견적유효일 : ${Object(m["dateToKorean"])(this.estimate.s_date2)} 까지`),this.estimate.n_magname&&s.text(100,260,`견적담당자 : ${this.estimate.n_magname}  ${this.estimate.t_magtel} `),this.estimate.t_remark&&s.text(12,267,"특 이 사 항 : "+this.estimate.t_remark),s.save(`견적서_${this.estimate.i_estno}.pdf`),this.$toast.success("다운로드 폴더에 PDF문서생성 하였습니다.")},doctext(t,e,i,s,a,l,n){if(!e)return;let o=i,d=s,r=0;r=t.getStringUnitWidth(e)*t.internal.getFontSize()/t.internal.scaleFactor,d=s+a/2-t.internal.getFontSize()/2,1==n?o=i+(l-r)/2:2==n&&(o=i+l-r),t.text(o,d,e)},rowSelectDetail:function(t,e){e.select(!0),this.itmelit=t},async addDetail(){this.edit&&(this.selectedD=[],this.itmelit=[],this.$refs.dialog_Item.open())},clickItem(){this.$refs.dialog_Item.open()},clickVend(){this.$refs.dialog_Vend.open()},async delDetail(){if(!this.editDetail)return;const t=this.itmelits.indexOf(this.itmelit);if(t>-1)if("0"==this.itmelits[t].f_editold)this.itmelits[t].f_edit="2"===this.itmelits[t].f_edit?"0":"2";else{this.itmelits.splice(t,1);const e=this.itmelitFilter.indexOf(this.itmelit);e>-1&&this.itmelitFilter.splice(e,1)}},getStatus(t){var e=this.ESTI001.find(e=>e.value===t);return void 0!==e?e.label:""},selectItem(t){this.itmelits.indexOf(this.itmelit);const e=this.itmelitFilter.indexOf(this.itmelit);if(e>=0)this.itmelitFilter[e].c_item=t.c_item,this.itmelitFilter[e].n_item=t.n_item,this.itmelitFilter[e].t_size=t.t_size,this.itmelitFilter[e].i_unit=t.i_unit,this.itmelitFilter[e].a_unit=t.a_sell,this.itmelitFilter[e].a_amt=this.itmelitFilter[e].m_cnt*t.a_sell;else{const e={};e.c_com=this.estimate.c_com,e.i_ser=this.estimate.i_ser,e.i_serno=Date.now(),e.s_sort=this.getMaxNo+1,e.i_estno=this.estimate.i_estno,e.c_item=t.c_item,e.n_item=t.n_item,e.t_size=t.t_size,e.i_unit=t.i_unit,e.i_type=t.i_type,e.m_cnt=1,e.a_unit=t.a_sell,e.a_amt=t.a_sell,e.s_duedate=this.estimate.s_date3,e.f_edit="1",e.f_editold="1",this.itmelitFilter.push(e),this.itmelits.push(e),this.selectedD.push(e)}this.onChangeAmt(),this.$refs.dialog_Item.close()},close_item(){},selectVend(t){const e=this.estimates.indexOf(this.estimate);e>=0&&(this.estimates[e].c_vend=t.c_vend,this.estimates[e].n_vend=t.n_vend,this.estimates[e].n_rname=t.n_mag,this.estimates[e].t_rtel=t.t_magtel,this.estimates[e].t_remail=t.t_magmail,this.onChangeMaster()),this.$refs.dialog_Vend.close()},onChangeMaster(){const t=this.estimates.indexOf(this.estimate);t>-1&&(this.estimates[t].f_edit="1")},onChangeMasterDate(){const t=this.estimates.indexOf(this.estimate);t>-1&&(this.estimates[t].f_edit="1"),this.itmelitFilter.forEach(t=>{(t.s_duedate<this.estimate.s_date3||null==t.s_duedate)&&(t.s_duedate=this.estimate.s_date3,t.f_edit="1")})},onChangeEstno(){const t=this.estimates.indexOf(this.estimate);t>-1&&(this.estimates[t].f_edit="1"),this.itmelitFilter.forEach(t=>{t.i_estno=this.estimate.i_estno,t.f_edit="1"})},onChangeDetail(){const t=this.itmelits.indexOf(this.itmelit);t>-1&&(this.itmelits[t].f_edit="1")},onChangeAmt(){this.onChangeDetail();const t=this.itmelits.indexOf(this.itmelit);t>-1&&(this.itmelits[t].a_amt=this.itmelits[t].a_unit*this.itmelits[t].m_cnt);let e=0;this.itmelitFilter.forEach(t=>{"2"!==t.f_edit&&(e+=1*t.a_amt)}),this.estimate.a_estamt=e,this.estimate.f_edit="1"},onChangeAmt2(){this.onChangeDetail();let t=0;this.itmelitFilter.forEach(e=>{"2"!==e.f_edit&&(t+=1*e.a_amt)}),this.estimate.a_estamt=t,this.estimate.f_edit="1"}}},k=C,w=i("2877"),$=Object(w["a"])(k,s,a,!1,null,null,null);e["default"]=$.exports},f3db:function(t,e,i){"use strict";var s=function(){var t=this,e=t._self._c;return e("v-dialog",{attrs:{persistent:"","max-width":"290"},scopedSlots:t._u([{key:"activator",fn:function({attrs:i}){return[e("v-text-field",t._b({staticClass:"my-text-table my-text-field",attrs:{dense:"","hide-details":"",value:t.value,readonly:t.readonly},on:{input:t.onInput},scopedSlots:t._u([t.readonly?null:{key:"append",fn:function(){return[e("v-btn",{attrs:{icon:"",small:"",tabindex:"-1"},on:{click:t.open}},[e("v-icon",[t._v("mdi-calendar-today")])],1)]},proxy:!0}],null,!0)},"v-text-field",{...t.$attrs,...i},!1))]}}]),model:{value:t.modal,callback:function(e){t.modal=e},expression:"modal"}},[e("v-card",[e("v-toolbar",[e("v-toolbar-title",[t._v(t._s(t.$attrs.label))]),e("v-spacer"),e("v-btn",{attrs:{icon:"",plain:""},on:{click:t.close}},[e("v-icon",[t._v("mdi-close")])],1)],1),e("v-date-picker",{attrs:{"no-title":"","day-format":t.dayFormat},on:{input:t.picker},model:{value:t.date,callback:function(e){t.date=e},expression:"date"}})],1)],1)},a=[],l={name:"InputDate2",model:{prop:"value",event:"input"},props:{value:String,readonly:Boolean},data(){return{modal:!1,date:""}},methods:{onInput(t){this.$emit("input",t)},open(){const t=/^\d{4}-\d{2}-\d{2}$/;this.date=t.test(this.value)?this.value:this.date,this.modal=!0},close(){this.modal=!1,this.modal2=!1},picker(){this.onInput(this.date),this.close()},dayFormat(t){if(!this.modal)return;const e=t.split("-");return Number(e[e.length-1])}}},n=l,o=i("2877"),d=Object(o["a"])(n,s,a,!1,null,null,null);e["a"]=d.exports}}]);
//# sourceMappingURL=Salesestimate.01d0cf9c.js.map
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Invoice"],{"1d50":function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t._self._c;return e("v-container",{attrs:{fluid:""}},[e("v-toolbar",{attrs:{height:"40px","background-color":"primary",dark:""}},[e("v-toolbar-title",[t._v("세금계산서등록(거래명세서)")]),e("v-spacer"),e("tooltip-btn",{attrs:{label:"계산서 조회"},on:{click:t.viewInvoice}},[e("v-icon",[t._v("mdi-magnify")])],1),e("tooltip-btn",{attrs:{label:"계산서 작성"},on:{click:t.addInvoice}},[e("v-icon",[t._v("mdi-plus")])],1),e("tooltip-btn",{attrs:{label:"계산서 삭제"},on:{click:t.delInvoice}},[e("v-icon",[t._v("mdi-minus")])],1),e("tooltip-btn",{attrs:{label:"계산서 저장"},on:{click:t.saveInvoice}},[e("v-icon",[t._v("mdi-content-save-outline")])],1),e("tooltip-btn",{attrs:{label:"거래명세서출력"},on:{click:t.printInvoce}},[e("v-icon",[t._v("mdi-printer")])],1)],1),e("v-card",{staticClass:"my-card text-input-blue my-text-fontsize",staticStyle:{display:"flex",height:"34px"}},[e("div",{staticStyle:{display:"flex"}},[e("div",{staticStyle:{width:"70px"}},[e("v-text-field",{staticClass:"no-padding",attrs:{value:"   발행일자 : ",readonly:"",dense:"","hide-details":""}})],1),e("input-dateft",{attrs:{value2:t.form.sDate2},on:{"update:value2":function(e){return t.$set(t.form,"sDate2",e)}},model:{value:t.form.sDate1,callback:function(e){t.$set(t.form,"sDate1",e)},expression:"form.sDate1"}}),e("div",{staticStyle:{width:"56px"}},[e("v-text-field",{staticClass:"no-padding",attrs:{value:"    고객사 : ",readonly:"",dense:"","hide-details":""}})],1),e("div",{staticStyle:{width:"100px"}},[e("v-text-field",{staticClass:"text-input-blue no-padding",attrs:{dense:"","hide-detail":""},model:{value:t.form.sVend,callback:function(e){t.$set(t.form,"sVend",e)},expression:"form.sVend"}})],1)],1)]),e("v-row",[e("v-col",{attrs:{col:"12",sm:"4",md:"4"}},[e("v-data-table",{ref:"table",staticClass:"elevation-1 text-no-wrap",attrs:{headers:t.masterHead,items:t.masters,"item-key":"i_invoiceser","single-select":"","items-per-page":-1,"hide-default-footer":"","footer-props":{"items-per-page-options":[10,20,30,40,50,100,-1]},height:t.iframeHeight},on:{"click:row":t.rowSelectMaster},scopedSlots:t._u([{key:"item.a_orderamt",fn:function({item:e}){return[t._v(" "+t._s(t.comma(e.a_orderamt))+" ")]}}],null,!0),model:{value:t.selectedM,callback:function(e){t.selectedM=e},expression:"selectedM"}})],1),e("v-col",{attrs:{col:"12",sm:"8",md:"8"}},[e("v-form",{ref:"form",attrs:{"lazy-validation":""},on:{submit:function(e){return e.preventDefault(),t.save.apply(null,arguments)}},model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[e("v-card",{attrs:{color:"grey lighten-4"}},[e("v-row",{staticClass:"my-text-field",attrs:{"no-gutters":""}},[e("v-col",{attrs:{col:"8",sm:"1",md:"1"}},[e("v-text-field",{staticClass:"text-input-redbrg no-padding",attrs:{value:"계산서번호",readonly:"",dense:"","hide-details":""}})],1),e("v-col",{attrs:{col:"8",sm:"3",md:"3"}},[e("v-text-field",{staticClass:"no-padding",attrs:{readonly:t.invoceend,dense:"","hide-details":""},on:{input:t.onChangeMaster},model:{value:t.masterinfo.i_invoiceno,callback:function(e){t.$set(t.masterinfo,"i_invoiceno",e)},expression:"masterinfo.i_invoiceno"}})],1),e("v-col",{attrs:{col:"8",sm:"4",md:"4"}}),e("v-col",{attrs:{col:"8",sm:"1",md:"1"}},[t.getStatus?e("v-chip",{attrs:{"x-small":"",color:t.getColor(this.masterinfo.f_status),dark:""},on:{dblclick:t.invoceEndjob}},[t._v(" "+t._s(t.getStatus))]):t._e()],1)],1),e("v-row",{staticClass:"my-text-field",attrs:{"no-gutters":""}},[e("v-col",{attrs:{col:"8",sm:"1",md:"1"}},[e("v-text-field",{staticClass:"text-input-redbrg no-padding",attrs:{value:"발행일자",readonly:"",dense:"","hide-details":""}})],1),e("v-col",{attrs:{col:"8",sm:"3",md:"3"}},[e("input-date-3",{attrs:{readonly:t.invoceend,rules:t.rules.date({required:!1})},on:{input:t.onChangeMaster},model:{value:t.masterinfo.d_invoice,callback:function(e){t.$set(t.masterinfo,"d_invoice",e)},expression:"masterinfo.d_invoice"}})],1)],1),e("v-row",{staticClass:"my-text-field",attrs:{"no-gutters":""}},[e("v-col",{attrs:{col:"8",sm:"1",md:"1"}},[e("v-text-field",{staticClass:"text-input-redbrg no-padding",attrs:{value:"고객사",readonly:"",dense:"","hide-details":""}})],1),e("v-col",{attrs:{col:"8",sm:"3",md:"3"}},[!t.invoceend&&t.changVend?e("v-text-field",{staticClass:"no-padding",attrs:{readonly:"",dense:"","hide-details":""},scopedSlots:t._u([{key:"append",fn:function(){return[e("v-btn",{attrs:{icon:"","x-small":"",tabindex:"-1"},on:{click:t.clickVend}},[e("v-icon",[t._v(" mdi-dialpad ")])],1)]},proxy:!0}],null,!1,3037295663),model:{value:t.masterinfo.n_vend,callback:function(e){t.$set(t.masterinfo,"n_vend",e)},expression:"masterinfo.n_vend"}}):e("v-text-field",{staticClass:"no-padding",attrs:{readonly:"",dense:"","hide-details":""},on:{input:t.onChangeMaster},model:{value:t.masterinfo.n_vend,callback:function(e){t.$set(t.masterinfo,"n_vend",e)},expression:"masterinfo.n_vend"}})],1),e("v-col",{attrs:{col:"8",sm:"2",md:"2"}}),e("v-col",{attrs:{col:"8",sm:"1",md:"1"}},[e("v-text-field",{staticClass:"text-input-redbrg no-padding",attrs:{value:"공급가액",readonly:"",dense:"","hide-details":""}})],1),e("v-col",{attrs:{col:"8",sm:"2",md:"2"}},[e("v-text-field",{staticClass:"text-input-redbrg inputPrice no-padding",attrs:{value:t.comma(t.masterinfo.a_amt)+"원",readonly:"",dense:"","hide-details":""}})],1)],1),e("v-row",{staticClass:"my-text-field",attrs:{"no-gutters":""}},[e("v-col",{attrs:{col:"8",sm:"1",md:"1"}},[e("v-text-field",{staticClass:"text-input-bluebrg no-padding",attrs:{value:"사업자번호",readonly:"",dense:"","hide-details":""}})],1),e("v-col",{attrs:{col:"8",sm:"2",md:"2"}},[e("v-text-field",{staticClass:"no-padding",attrs:{readonly:"",dense:"","hide-details":""},on:{input:t.onChangeMaster},model:{value:t.masterinfo.i_company,callback:function(e){t.$set(t.masterinfo,"i_company",e)},expression:"masterinfo.i_company"}})],1),e("v-col",{attrs:{col:"8",sm:"1",md:"1"}},[e("v-text-field",{staticClass:"text-input-bluebrg no-padding",attrs:{value:"대표자",readonly:"",dense:"","hide-details":""}})],1),e("v-col",{attrs:{col:"8",sm:"2",md:"2"}},[e("v-text-field",{staticClass:"no-padding",attrs:{readonly:"",dense:"","hide-details":""},on:{input:t.onChangeMaster},model:{value:t.masterinfo.n_ceo,callback:function(e){t.$set(t.masterinfo,"n_ceo",e)},expression:"masterinfo.n_ceo"}})],1),e("v-col",{attrs:{col:"8",sm:"1",md:"1"}},[e("v-text-field",{staticClass:"text-input-redbrg no-padding",attrs:{value:"VAT",readonly:"",dense:"","hide-details":""}})],1),e("v-col",{attrs:{col:"8",sm:"2",md:"2"}},[e("v-text-field",{staticClass:"text-input-redbrg inputPrice no-padding",attrs:{value:t.comma(t.masterinfo.a_vat)+"원",readonly:"",dense:"","hide-details":""}})],1)],1),e("v-row",{staticClass:"my-text-field",attrs:{"no-gutters":""}},[e("v-col",{attrs:{col:"8",sm:"1",md:"1"}},[e("v-text-field",{staticClass:"text-input-bluebrg no-padding",attrs:{value:"업태",readonly:"",dense:"","hide-details":""}})],1),e("v-col",{attrs:{col:"8",sm:"2",md:"2"}},[e("v-text-field",{staticClass:"no-padding",attrs:{readonly:"",dense:"","hide-details":""},on:{input:t.onChangeMaster},model:{value:t.masterinfo.t_job1,callback:function(e){t.$set(t.masterinfo,"t_job1",e)},expression:"masterinfo.t_job1"}})],1),e("v-col",{attrs:{col:"8",sm:"1",md:"1"}},[e("v-text-field",{staticClass:"text-input-bluebrg no-padding",attrs:{value:"업종",readonly:"",dense:"","hide-details":""}})],1),e("v-col",{attrs:{col:"8",sm:"2",md:"2"}},[e("v-text-field",{staticClass:"no-padding",attrs:{readonly:"",dense:"","hide-details":""},on:{input:t.onChangeMaster},model:{value:t.masterinfo.t_job2,callback:function(e){t.$set(t.masterinfo,"t_job2",e)},expression:"masterinfo.t_job2"}})],1)],1),e("v-row",{staticClass:"my-text-field",attrs:{"no-gutters":""}},[e("v-col",{attrs:{col:"8",sm:"1",md:"1"}},[e("v-text-field",{staticClass:"text-input-bluebrg no-padding",attrs:{value:"전화번호",readonly:"",dense:"","hide-details":""}})],1),e("v-col",{attrs:{col:"8",sm:"2",md:"2"}},[e("v-text-field",{staticClass:"no-padding",attrs:{readonly:"",dense:"","hide-details":""},on:{input:t.onChangeMaster},model:{value:t.masterinfo.t_tel,callback:function(e){t.$set(t.masterinfo,"t_tel",e)},expression:"masterinfo.t_tel"}})],1),e("v-col",{attrs:{col:"8",sm:"1",md:"1"}},[e("v-text-field",{staticClass:"text-input-bluebrg no-padding",attrs:{value:"FAX",readonly:"",dense:"","hide-details":""}})],1),e("v-col",{attrs:{col:"8",sm:"2",md:"2"}},[e("v-text-field",{staticClass:"no-padding",attrs:{readonly:"",dense:"","hide-details":""},on:{input:t.onChangeMaster},model:{value:t.masterinfo.t_fax,callback:function(e){t.$set(t.masterinfo,"t_fax",e)},expression:"masterinfo.t_fax"}})],1),e("v-col",{attrs:{col:"8",sm:"1",md:"1"}},[e("v-text-field",{staticClass:"text-input-bluebrg no-padding",attrs:{value:"이메일",readonly:"",dense:"","hide-details":""}})],1),e("v-col",{attrs:{col:"8",sm:"2",md:"2"}},[e("v-text-field",{staticClass:"no-padding",attrs:{readonly:"",dense:"","hide-details":""},on:{input:t.onChangeMaster},model:{value:t.masterinfo.e_mail,callback:function(e){t.$set(t.masterinfo,"e_mail",e)},expression:"masterinfo.e_mail"}})],1)],1),e("v-row",{staticClass:"my-text-field",attrs:{"no-gutters":""}},[e("v-col",{attrs:{col:"8",sm:"1",md:"1"}},[e("v-text-field",{staticClass:"text-input-bluebrg no-padding",attrs:{value:"주소",readonly:"",dense:"","hide-details":""}})],1),e("v-col",{attrs:{col:"8",sm:"8",md:"8"}},[e("v-text-field",{staticClass:"no-padding",attrs:{readonly:"",dense:"","hide-details":""},on:{input:t.onChangeMaster},model:{value:t.masterinfo.t_addr,callback:function(e){t.$set(t.masterinfo,"t_addr",e)},expression:"masterinfo.t_addr"}})],1)],1)],1)],1),e("v-toolbar",{attrs:{height:"35px",color:"accent"}},[e("v-toolbar-title",[t._v("계산서 품목 List")]),e("v-spacer"),e("tooltip-btn",{attrs:{label:"추가",fab:"","x-small":""},on:{click:t.addItem}},[e("v-icon",[t._v("mdi-plus")])],1),e("tooltip-btn",{attrs:{label:"삭제",fab:"","x-small":""},on:{click:t.delItem}},[e("v-icon",[t._v("mdi-minus")])],1)],1),e("v-data-table",{ref:"tabledt",staticClass:"elevation-1 text-no-wrap no-padding",attrs:{headers:t.itemHead,items:t.itemLists,"item-key":"i_invoiceserno","single-select":"","items-per-page":-1,"hide-default-footer":"","footer-props":{"items-per-page-options":[10,20,30,40,50,100,-1]},"item-class":t.row_classes,height:t.iframeHeight-220},on:{"click:row":t.rowSelectDetail},scopedSlots:t._u([{key:"item.m_cnt",fn:function({item:i}){return[!t.invoceend&&t.changVend&&i.i_invoiceserno===t.itemInfo.i_invoiceserno?e("input-number",{attrs:{maxlength:4},on:{input:function(e){return t.onChangeAmt("cnt")}},model:{value:i.m_cnt,callback:function(e){t.$set(i,"m_cnt",e)},expression:"item.m_cnt"}}):e("span",[t._v(t._s(t.comma(i.m_cnt)))])]}},{key:"item.a_unit",fn:function({item:i}){return[t.invoceend||i.i_invoiceserno!==t.itemInfo.i_invoiceserno?e("span",[e("div",{staticClass:"right2-align"},[t._v(" "+t._s(t.comma(i.a_unit)))])]):e("input-amt",{on:{input:function(e){return t.onChangeAmt("unit")}},model:{value:i.a_unit,callback:function(e){t.$set(i,"a_unit",e)},expression:"item.a_unit"}})]}},{key:"item.a_inamt",fn:function({item:i}){return[t.invoceend||i.i_invoiceserno!==t.itemInfo.i_invoiceserno?e("span",[e("div",{staticClass:"right2-align"},[t._v(" "+t._s(t.comma(i.a_inamt)))])]):e("input-amt",{on:{input:function(e){return t.onChangeAmt("amt")}},model:{value:i.a_inamt,callback:function(e){t.$set(i,"a_inamt",e)},expression:"item.a_inamt"}})]}},{key:"item.a_invat",fn:function({item:i}){return[t.invoceend||i.i_invoiceserno!==t.itemInfo.i_invoiceserno?e("span",[e("div",{staticClass:"right2-align"},[t._v(" "+t._s(t.comma(i.a_invat)))])]):e("input-amt",{on:{input:function(e){return t.onChangeAmt2("vat")}},model:{value:i.a_invat,callback:function(e){t.$set(i,"a_invat",e)},expression:"item.a_invat"}})]}},{key:"item.t_remark",fn:function({item:i}){return[t.invoceend||i.i_invoiceserno!==t.itemInfo.i_invoiceserno?e("span",[e("div",{staticClass:"left-align"},[t._v(t._s(i.t_remark))])]):e("v-text-field",{staticClass:"my-text-field",attrs:{dense:"","hide-details":""},on:{input:t.onChangeDetail},model:{value:i.t_remark,callback:function(e){t.$set(i,"t_remark",e)},expression:"item.t_remark"}})]}}],null,!0),model:{value:t.selectedD,callback:function(e){t.selectedD=e},expression:"selectedD"}})],1)],1),e("ez-dialog",{ref:"dialog_Vend",attrs:{label:"거래처",persistent:"",width:"460px"},on:{onClose:t.close_item}},[e("vend-pop",{on:{onSelect:t.selectVend}})],1),e("ez-dialog",{ref:"dialog_Item",attrs:{label:"항목/품목",persistent:"",width:"460px"},on:{onClose:t.close_item}},[e("item-pop",{on:{onSelect:t.selectItem}})],1),e("ez-dialog",{ref:"dialog_Insert",attrs:{label:"출하(출고) 선택",width:"650px"}},[e("invoice-derliveritem",{attrs:{data:t.invoicedata,newInvoce:t.newInvoce},on:{onEnter:t.newAdd1}})],1)],1)},n=[],a=(i("14d9"),i("2f62")),o=i("a2e4"),l=i("414b"),r=i("d1b1"),d=i("1c76"),c=i("121b"),m=i("6b39"),_=i("248f"),h=i.n(_),f=i("64f2"),v=i("12e3"),u=i("3bcf"),p=i("c477"),x=function(){var t=this,e=t._self._c;return e("div",[e("v-toolbar",{attrs:{height:"40px","background-color":"primary",dark:""}},[e("v-spacer"),e("v-btn",{attrs:{small:"",color:t.getCheck?"success":"warning"},on:{click:t.addInvoice}},[t._v(" "+t._s(t.newInvoce?t.getCheck?"계산서 작성":"미 출하계산서":"계산선 품목 추가"))])],1),e("v-data-table",{staticClass:"elevation-1 text-no-wrap",attrs:{headers:t.Head,items:t.data,"item-key":"i_shipser",height:"300px","max-height":"300px"},scopedSlots:t._u([{key:"item",fn:function({item:i}){return[e("tr",{staticClass:"center-align"},[e("td",[e("v-checkbox",{staticStyle:{margin:"0",padding:"0"},attrs:{"true-value":"1","false-value":"0",dense:"","hide-details":""},on:{change:function(e){return t.checkboxChanged(i)}},model:{value:i.f_select,callback:function(e){t.$set(i,"f_select",e)},expression:"item.f_select"}})],1),e("td",[t._v(" "+t._s(i.d_ship)+" ")]),e("td",[t._v(" "+t._s(i.i_shipno)+" ")]),e("td",[t._v(" "+t._s(i.n_vend)+" ")]),e("td",[t._v(" "+t._s(i.n_item)+" ")]),e("td",[t._v(" "+t._s(i.t_size)+" ")]),e("td",[t._v(" "+t._s(i.m_shipcnt)+" ")])])]}}]),model:{value:t.selected,callback:function(e){t.selected=e},expression:"selected"}})],1)},g=[],b={name:"InvoiceDerliveritem",props:{data:{type:Array,default:null},newInvoce:{type:Boolean,default:!0}},data(){return{comma:f["comma"],Head:[{text:"선택",value:"f_select",sortable:!1,align:"center",width:"25px"},{text:"출하일자",value:"d_ship",sortable:!1,align:"center",width:"65px"},{text:"출하번호",value:"i_shipno",sortable:!1,align:"center",width:"65px"},{text:"거래처",value:"n_vend",sortable:!1,align:"center",width:"70px"},{text:"항목(품목)",value:"n_item",sortable:!1,align:"center",width:"130px"},{text:"규격(사양)",value:"t_size",sortable:!1,align:"center",width:"100px"},{text:"수량",value:"m_shipcnt",sortable:!1,align:"center",width:"60px"}],selected:[]}},watch:{data:{deep:!0,handler(t,e){}}},computed:{getCheck(){return this.data.filter(t=>"1"===t.f_select).length}},methods:{rowSelect:function(t,e){e.select(!0),this.selectest=t},async enterSelect(t,{item:e}){this.selectest=e,this.$emit("onEnter",this.selectest)},async addInvoice(){const t=this.data.filter(t=>"1"===t.f_select);if(t.length){const e=Array.from(new Set(t.map(t=>t["c_vend"])));if(e.length>1)return void this.$ezNotify.alert(e+" <br>","거래처 중복",{icon:"mdi-message-bulleted"})}(this.newInvoce||t.length)&&this.$emit("onEnter",t)},checkboxChanged(t){}}},y=b,w=i("2877"),I=Object(w["a"])(y,x,g,!1,null,null,null),k=I.exports,C=i("4328"),$=i.n(C),L=i("8baf"),S=(i("0da4"),i("816b")),D={components:{EzDialog:o["a"],InputDateft:r["a"],TooltipBtn:l["a"],InputAmt:d["a"],InputNumber:c["a"],InputDate3:m["a"],ItemPop:u["a"],VendPop:p["a"],InvoiceDerliveritem:k},name:"Invoice",mounted(){window.addEventListener("resize",this.adjustIframeHeight),this.adjustIframeHeight(),this.init()},beforeDestroy(){window.removeEventListener("resize",this.adjustIframeHeight)},data(){return{valid:!0,comma:f["comma"],IVCOICE01:v["b"],iframeHeight:500,form:{sDate1:"",sDate2:"",sVend:""},invoiceVend:{c_vend:""},newInvoce:!0,masterHead:[{text:"발행일자",value:"d_invoice",sortable:!1,align:"center",width:"55px"},{text:"계산서번호",value:"i_invoiceno",sortable:!1,align:"center",width:"70px"},{text:"고객사",value:"n_vend",sortable:!1,align:"center",width:"100px"}],masters:[],masterinfo:[],selectedM:[],itemHead:[{text:"No",value:"s_sort",sortable:!1,align:"center",width:"35px"},{text:"항목(품목)",value:"n_item",sortable:!1,align:"center",width:"130px"},{text:"규격(사양)",value:"t_size",sortable:!1,align:"center",width:"100px"},{text:"단위",value:"i_unit",sortable:!1,align:"center",width:"90px"},{text:"수량",value:"m_cnt",sortable:!1,align:"center",width:"60px"},{text:"단가",value:"a_unit",sortable:!1,align:"center",width:"60px"},{text:"금액",value:"a_inamt",sortable:!1,align:"center",width:"60px"},{text:"VAT",value:"a_invat",sortable:!1,align:"center",width:"60px"},{text:"비고",value:"t_remark",sortable:!1,align:"center",width:"150px"},{text:"출하번호",value:"i_shipno",sortable:!1,align:"center",width:"60px"}],itemLists:[],itemInfo:[],selectedD:[],item:[],invoicedata:[],derliverlist:[],comImageLog:""}},computed:{rules:()=>h.a,invoceend(){return!this.masterinfo.f_status||"1"==this.masterinfo.f_status},editJob(){if("1"==this.masterinfo.f_edit)return!0;let t=0;return this.itemLists.forEach(e=>{"1"!=e.f_edit&&"2"!=e.f_edit||t++}),0!=t},changVend(){return"0"==this.masterinfo.f_witre},getStatus(){var t=this.IVCOICE01.find(t=>t.value==this.masterinfo.f_status);return void 0!==t?t.label:""},siteImglog(){return!!this.comImageLog.t_worklog&&this.comImageLog.t_worklog}},methods:{...Object(a["b"])("shipment",["iuInvoicelist","invoiceNochk"]),getColor(t){return"1"==t?"green":"0"==this.masterinfo.f_status?"red":"green"},adjustIframeHeight(){const t=window.innerHeight;this.iframeHeight=t-200},async init(){this.form.sDate1=Object(f["getDate"])(-100,1),this.viewInvoice(),this.comImageLog=await this.$axios.post("/api/system/getSiteImage")},async rowSelectMaster(t,e){if(this.masterinfo.i_invoiceno!=t.i_invoiceno){if(this.invoiceVend.c_vend=t.c_vend,this.editJob){const t=await this.$ezNotify.confirm("수정내용이 존재 합니다.<br><br>수정 내용을 취소 하시게습니까 ?","자료확인",{icon:"mdi-message-bulleted-off",width:350});if(!t)return;const e=this.masters.indexOf(this.masterinfo);if(e>=0)if("1"!==this.masterinfo.f_editold){const t=await this.$axios.post("/api/shipment/getInvoicelistInfo",this.masterinfo);t.length?this.masters.splice(e,1,t[0]):this.masters.splice(e,1)}else this.masters.splice(e,1)}this.masterinfo=t,e?e.select(!0):this.selectedM=[t],"1"==t.f_edit&&"1"==t.f_editold||(this.selectedD=[],this.itemInfo=[],this.itemLists=await this.$axios.post("/api/shipment/getInvoicelistdt",this.masterinfo))}},onChangeMaster(){const t=this.masters.indexOf(this.masterinfo);t>-1&&(this.masters[t].f_edit="1")},async viewInvoice(){this.masterinfo=[],this.selectedM=[],this.itemLists=[],this.itemInfo=[],this.masters=await this.$axios.post("/api/shipment/getInvoicelist",this.form)},async addInvoice(){this.editJob||(this.invoiceVend.c_vend="",this.newInvoce=!0,await this.addInvoiceJob())},async addInvoiceJob(){this.derliverlist=await this.$axios.post("/api/shipment/getDeliverNotInsert",this.invoiceVend);const t=this.derliverlist.filter(t=>!this.itemLists.some(e=>e.i_shipser===t.i_shipser));this.invoicedata=Array.from(new Set(t.map(t=>JSON.stringify({c_com:t.c_com,f_select:"0",i_shipser:t.i_shipser,d_ship:t.d_ship,i_shipno:t.i_shipno,i_order:t.i_order,i_orderser:t.i_orderser,m_shipcnt:t.m_shipcnt,c_vend:t.c_vend,n_vend:t.n_vend,c_item:t.c_item,n_item:t.n_item,t_size:t.t_size,i_unit:t.i_unit,i_type:t.i_type,a_unit:t.a_unit,a_amt:t.a_amt,n_compnay:t.n_compnay,n_ceo:t.n_ceo,i_company:t.i_company,t_job1:t.t_job1,t_job2:t.t_job2,t_tel:t.t_tel,t_fax:t.t_fax,e_mail:t.e_mail,t_addr:t.t_addr}))),JSON.parse),this.$refs.dialog_Insert.open()},async delInvoice(){if(this.invoceend)return void await this.$ezNotify.alert("확정 자료입니다.","삭제불가",{icon:"mdi-message-bulleted-off",width:250});if("1"!=this.masterinfo.f_editold){if("1"==this.masterinfo.f_witre&&this.itemLists.length)return void await this.$ezNotify.alert("계산서 품록 List 삭제 후 삭제 가능 !","삭제불가",{icon:"mdi-message-bulleted-off",width:400});const t=await this.$ezNotify.confirm("삭제 하시겠습니까 ?","삭제",{icon:"mdi-message-bulleted-off",width:350});if(!t)return;const e=await this.$axios.delete(`/api/shipment/delInvoic/${this.masterinfo.c_com}/${this.masterinfo.i_invoiceser}`);if(!e)return}this.itemInfo=[];const t=this.masters.indexOf(this.masterinfo);t>=0&&this.masters.splice(t,1),this.masterinfo=[],this.itemLists=[],this.$toast.info("삭제 하였습니다.")},async saveInvoice(){if(this.invoceend)return;if(!this.editJob)return;if(null==this.masterinfo.i_invoiceno||this.masterinfo.i_invoiceno.length<1||"TEMP"==this.masterinfo.i_invoiceno.toUpperCase().trim())return void this.$toast.error("계산서번호 입력 필수 입니다.");const t=await this.invoiceNochk(this.masterinfo);if(t)return void this.$toast.error("계산서번호 중복 입니다.");let e=0;this.itemLists.forEach(t=>{"2"!==t.f_edit&&(e+=1,t.s_sort=e)});const i=Object.assign({},this.masterinfo,this.itemLists),s=await this.iuInvoicelist(i);if(s){for(let t=this.itemLists.length-1;t>=0;t--)"2"==this.itemLists[t].f_edit&&this.itemLists.splice(t,1);this.itemLists.forEach(t=>{t.f_edit="0",t.f_editold="0"}),this.masterinfo.f_edit="0",this.masterinfo.f_editold="0",this.$toast.info("저장 하였습니다.")}else await this.$ezNotify.alert("저장 중 오류가 발생 하였습니다...","오류",{icon:"mdi-message-bulleted"})},clickVend(){this.$refs.dialog_Vend.open()},selectVend(t){const e=this.masters.indexOf(this.masterinfo);e>=0&&(this.masters[e].c_vend=t.c_vend,this.masters[e].n_vend=t.n_vend,this.masters[e].n_compnay=t.n_compnay,this.masters[e].n_ceo=t.n_ceo,this.masters[e].i_company=t.i_company,this.masters[e].t_job1=t.t_job1,this.masters[e].t_job2=t.t_job2,this.masters[e].t_tel=t.t_tel,this.masters[e].t_fax=t.t_fax,this.masters[e].e_mail=t.e_mail,this.masters[e].t_addr=t.t_addr,this.onChangeMaster()),this.$refs.dialog_Vend.close()},selectItem(t){if(this.$refs.dialog_Item.close(),!t)return;const e={};e.c_com=this.masterinfo.c_com,e.i_invoiceser=this.masterinfo.i_invoiceser,e.i_invoiceserno=Date.now(),e.s_sort=this.itemLists.length+1,e.a_inamt=t.a_sell,e.a_invat=t.a_sell/10,e.i_order="",e.i_orderser="",e.i_shipser="",e.i_shipno="",e.c_item=t.c_item,e.n_item=t.n_item,e.t_size=t.t_size,e.i_unit=t.i_unit,e.i_type=t.i_type,e.m_cnt=1,e.a_unit=t.a_sell,e.a_amt=t.a_sell,e.t_remark="",e.n_crnm="",e.d_create_at="",e.n_upnm="",e.d_update_at="",e.f_edit="1",e.f_editold="1";const i=this.itemLists.push(e),s=this.$refs.tabledt;if(s){const t=this.itemLists[i-1];s.$emit("click:row",t)}this.onChangeAmt2()},close_item(){},rowSelectDetail:function(t,e){e?e.select(!0):this.selectedD=[t],this.itemInfo=t},onChangeDetail(){const t=this.itemLists.indexOf(this.itemInfo);t>-1&&"0"==this.itemInfo.f_edit&&(this.itemLists[t].f_edit="1")},onChangeAmt(t){this.onChangeDetail();const e=this.itemLists.indexOf(this.itemInfo);e>-1&&("amt"!==t&&(this.itemLists[e].a_inamt=this.itemLists[e].a_unit*this.itemLists[e].m_cnt),"vat"!==t&&(this.itemLists[e].a_invat=Math.floor(this.itemLists[e].a_inamt/10)));let i=0,s=0;this.itemLists.forEach(t=>{"2"!==t.f_edit&&(i+=1*t.a_inamt,s+=1*t.a_invat)}),this.masterinfo.a_amt=i,this.masterinfo.a_vat=s,this.masterinfo.f_edit="1"},onChangeAmt2(t){this.onChangeDetail();let e=0,i=0;this.itemLists.forEach(t=>{"2"!==t.f_edit&&(e+=1*t.a_inamt,i+=1*t.a_invat)}),this.masterinfo.a_amt=e,this.masterinfo.a_vat="vat"==t?i:Math.floor(e/10),this.masterinfo.f_edit="1"},async addItem(){this.invoceend||(this.newInvoce=!1,"1"==this.masterinfo.f_witre?(this.invoiceVend.c_vend=this.masterinfo.c_vend,await this.addInvoiceJob()):await this.$refs.dialog_Item.open())},async delItem(){if(this.invoceend)return;const t=this.itemLists.indexOf(this.itemInfo);if(t>-1)if("0"==this.itemLists[t].f_editold)this.itemLists[t].f_edit="2"===this.itemInfo.f_edit?"0":"2";else{this.itemLists.splice(t,1);const e=this.itemLists.indexOf(this.itemInfo);e>-1&&this.itemLists.splice(e,1)}this.onChangeAmt2()},row_classes(t){if("2"==t.f_edit)return"orange"},async newAdd1(t){if(this.$refs.dialog_Insert.close(),!t.length)return void this.newAdd2();const e=Date.now();if(this.newInvoce){this.itemLists=[];const i={};i.c_com=t[0].c_com,i.i_invoiceser=e,i.i_invoiceno="Temp",i.d_invoice=Object(f["getDate"])(),i.f_status="0",i.f_witre="1",i.a_amt=0,i.a_vat=0,i.c_vend=t[0].c_vend,i.n_vend=t[0].n_vend,i.n_compnay=t[0].n_compnay,i.n_ceo=t[0].n_ceo,i.i_company=t[0].i_company,i.t_job1=t[0].t_job1,i.t_job2=t[0].t_job2,i.t_tel=t[0].t_tel,i.t_fax=t[0].t_fax,i.e_mail=t[0].e_mail,i.t_addr=t[0].t_addr,i.n_end="",i.d_end="",i.n_crnm="",i.d_create_at="",i.n_upnm="",i.d_update_at="",i.f_edit="1",i.f_editold="1";const s=this.masters.push(i),n=this.$refs.table;if(n){const t=this.masters[s-1];n.$emit("click:row",t)}}t.forEach((i,s)=>{const n={};n.c_com=t[0].c_com,n.i_invoiceser=this.newInvoce?e:this.masterinfo.i_invoiceser,n.i_invoiceserno=e+s,n.s_sort=this.itemLists.length+1,n.a_inamt=i.a_amt,n.a_invat=i.a_amt/10,n.i_order=i.i_order,n.i_orderser=i.i_orderser,n.i_shipser=i.i_shipser,n.i_shipno=i.i_shipno,n.c_item=i.c_item,n.n_item=i.n_item,n.t_size=i.t_size,n.i_unit=i.i_unit,n.i_type=i.i_type,n.m_cnt=i.m_shipcnt,n.a_unit=i.a_unit,n.a_amt=i.a_amt,n.t_remark="",n.n_crnm="",n.d_create_at="",n.n_upnm="",n.d_update_at="",n.f_edit="1",n.f_editold="1";this.itemLists.push(n)}),this.onChangeAmt2()},async newAdd2(){if(this.newInvoce){const t={};t.c_com=this.$store.state.user.member.c_com,t.i_invoiceser=Date.now(),t.i_invoiceno="Temp",t.d_invoice=Object(f["getDate"])(),t.f_status="0",t.f_witre="0",t.a_amt=0,t.a_vat=0,t.c_vend="",t.n_vend="",t.n_compnay="",t.n_ceo="",t.i_company="",t.t_job1="",t.t_job2="",t.t_tel="",t.t_fax="",t.e_mail="",t.t_addr="",t.n_end="",t.d_end="",t.n_crnm="",t.d_create_at="",t.n_upnm="",t.d_update_at="",t.f_edit="1",t.f_editold="1";const e=this.masters.push(t),i=this.$refs.table;if(i){const t=this.masters[e-1];i.$emit("click:row",t)}}},async invoceEndjob(){const t=this.masters.indexOf(this.masterinfo);if((!this.editJob||(this.$toast.warning("저장 후 상태 변경 가능 합니다."),res))&&t>=0){if(parseInt(this.masterinfo.f_status)>1)return;const t=await this.$ezNotify.confirm(`계산서 상태 ${"1"==this.masterinfo.f_status?"취소":"확정"} 처리 하시 겠습니까 ?`,"확정 "+("1"==this.masterinfo.f_status?"취소":"처리"),{icon:"mdi-message-bulleted-off",width:350});if(!t)return;const e=await this.$axios.post("/api/shipment/iuInvoiceJobend",this.masterinfo);e&&(this.masterinfo.f_status="1"==this.masterinfo.f_status?"0":"1",this.$toast.info("처리 하였습니다."))}},async printInvoce(){let t=$.a.stringify({c_com:this.$store.state.user.member.c_com});const e=await this.$axios.get("/api/system/getCompany?"+t),i=new L["default"]("p","mm","a4");if(this.siteImglog){const t=new Image;t.src=this.siteImglog,i.addImage(t,"JPEG",150,30,50,20)}i.addFileToVFS("malgun.ttf",S["a"]),i.addFont("malgun.ttf","malgun","normal"),i.setFont("malgun"),i.setFontSize(30),i.text("거 래 명 세 표",60,30),i.setFontSize(9),i.setLineWidth(.1),i.rect(10,50,190,230),i.rect(10,50,8,24),i.text(13,56,"공"),i.text(13,64,"급"),i.text(13,72,"자"),i.rect(18,50,13,24),i.rect(18,50,87,6),this.doctext(i,"등록번호",18,56,6,6,0),this.doctext(i,e[0].c1,31,56,6,70,1),i.rect(18,56,87,6),this.doctext(i,"상 호 명",18,62,6,6,0),this.doctext(i,e[0].c2,31,62,6,30,1),i.rect(63,56,13,6),this.doctext(i,"성     명",63,62,6,6,0),this.doctext(i,e[0].c3,76,62,6,28,1),i.rect(18,62,87,6),this.doctext(i,"주     소",18,68,6,6,0),this.doctext(i,e[0].c4,31,68,6,70,1),i.rect(18,68,87,6),this.doctext(i,"업     태",18,74,6,6,0),this.doctext(i,e[0].c5,31,74,6,30,1),i.rect(63,68,13,6),this.doctext(i,"업     종",63,74,6,6,0),this.doctext(i,e[0].c6,76,74,6,28,1),i.rect(105,50,8,24),i.text(108,56,"공"),i.text(108,60,"급"),i.text(108,64,"받"),i.text(108,68,"는"),i.text(108,72,"자"),i.rect(113,50,13,24),i.rect(113,50,87,6),this.doctext(i,"등록번호",113,56,6,6,0),this.doctext(i,this.masterinfo.i_company,126,56,6,70,1),i.rect(113,56,87,6),this.doctext(i,"상 호 명",113,62,6,6,0),this.doctext(i,this.masterinfo.n_compnay,126,62,6,30,1),i.rect(158,56,13,6),this.doctext(i,"성     명",158,62,6,6,0),this.doctext(i,this.masterinfo.n_ceo,171,62,6,28,1),i.rect(113,62,87,6),this.doctext(i,"주     소",113,68,6,6,0),this.doctext(i,this.masterinfo.t_addr,126,68,6,70,1),i.rect(113,68,87,6),this.doctext(i,"업     태",113,74,6,6,0),this.doctext(i,this.masterinfo.t_job1,126,74,6,30,1),i.rect(158,68,13,6),this.doctext(i,"업     종",158,74,6,6,0),this.doctext(i,this.masterinfo.t_job2,171,74,6,28,1);for(let a=0;a<26;a++)0==a||25==a?(i.setFillColor(192,192,192),i.rect(10,74+7*a,190,7,"FD"),i.setFillColor(255,255,255)):i.rect(10,74+7*a,190,7);i.line(16,74,16,256),i.text(11,79,"No"),i.line(60,74,60,256),i.text(35,79,"품명"),i.line(100,74,100,256),i.text(75,79,"규격"),i.line(120,74,120,256),i.text(106,79,"단위"),i.line(130,74,130,256),i.text(122,79,"수량"),i.line(150,74,150,256),i.text(137,79,"단가"),i.line(172,74,172,256),i.text(158,79,"금액"),i.text(184,79,"비고");let s=0,n=0;this.itemLists.forEach((t,e)=>{s=73+7*(e+2),this.doctext(i,(e+1).toString(),10,s,7,6,1),this.doctext(i,t.n_item,16,s,7,6,0),this.doctext(i,t.t_size,60,s,7,6,0),this.doctext(i,t.i_unit,100,s,7,20,1),this.doctext(i,t.m_cnt.toString(),120,s,7,10,1),this.doctext(i,this.comma(t.a_unit),130,s,7,20,2),this.doctext(i,this.comma(t.a_amt),150,s,7,22,2),this.doctext(i,t.t_remark,172,s,7,28,0),t.a_amt&&(n+=1*t.a_amt)}),s=73+7*(this.itemLists.length+2),this.doctext(i,"- 이 하 여 백 -",60,s,7,40,1),i.setFontSize(10),s=255,this.doctext(i,"합 계",100,s,7,20,1),this.doctext(i,this.comma(n),150,s,7,22,2),i.setFontSize(9),i.text(12,260,"비    고 : "),i.save(`거래명세서_${this.masterinfo.i_invoiceno}.pdf`),this.$toast.success("다운로드 폴더에 PDF문서생성 하였습니다.")},doctext(t,e,i,s,n,a,o){if(!e)return;let l=i,r=s,d=0;d=t.getStringUnitWidth(e)*t.internal.getFontSize()/t.internal.scaleFactor,r=s+n/2-t.internal.getFontSize()/2,1==o?l=i+(a-d)/2:2==o&&(l=i+a-d),t.text(l,r,e)}}},j=D,z=Object(w["a"])(j,s,n,!1,null,null,null);e["default"]=z.exports},d1b1:function(t,e,i){"use strict";var s=function(){var t=this,e=t._self._c;return e("div",{staticStyle:{width:"190px",display:"flex"}},[e("v-dialog",{attrs:{persistent:"","max-width":"290"},scopedSlots:t._u([{key:"activator",fn:function({attrs:i}){return[e("v-text-field",t._b({staticClass:"my-text-field",attrs:{dense:"","hide-details":"",value:t.value,readonly:t.readonly},on:{input:t.onInput},scopedSlots:t._u([t.readonly?null:{key:"append",fn:function(){return[e("v-btn",{attrs:{icon:"",small:"",tabindex:"-1"},on:{click:t.open}},[e("v-icon",[t._v("mdi-calendar-today")])],1)]},proxy:!0}],null,!0)},"v-text-field",{...t.$attrs,...i},!1))]}}]),model:{value:t.modal,callback:function(e){t.modal=e},expression:"modal"}},[e("v-card",[e("v-toolbar",[e("v-toolbar-title",[t._v(t._s(t.$attrs.label))]),e("v-spacer"),e("v-btn",{attrs:{icon:"",plain:""},on:{click:t.close}},[e("v-icon",[t._v("mdi-close")])],1)],1),e("v-date-picker",{attrs:{"no-title":"","day-format":t.dayFormat},on:{input:t.picker},model:{value:t.date,callback:function(e){t.date=e},expression:"date"}})],1)],1),e("v-text-field",{staticClass:"no-padding",staticStyle:{width:"20px","border-bottom":"none"},attrs:{dense:"","hide-details":"",value:"∽",readonly:t.readonly},on:{input:t.onInput}}),e("v-dialog",{attrs:{persistent:"","max-width":"290"},scopedSlots:t._u([{key:"activator",fn:function({attrs:i}){return[e("v-text-field",t._b({staticClass:"my-text-field",attrs:{dense:"","hide-details":"",value:t.value2,readonly:t.readonly},on:{input:t.onInput2},scopedSlots:t._u([t.readonly?null:{key:"append",fn:function(){return[e("v-btn",{attrs:{icon:"",small:"",tabindex:"-1"},on:{click:t.open2}},[e("v-icon",[t._v("mdi-calendar-today")])],1)]},proxy:!0}],null,!0)},"v-text-field",{...t.$attrs,...i},!1))]}}]),model:{value:t.modal2,callback:function(e){t.modal2=e},expression:"modal2"}},[e("v-card",[e("v-toolbar",[e("v-toolbar-title",[t._v(t._s(t.$attrs.label))]),e("v-spacer"),e("v-btn",{attrs:{icon:"",plain:""},on:{click:t.close}},[e("v-icon",[t._v("mdi-close")])],1)],1),e("v-date-picker",{attrs:{"no-title":"","day-format":t.dayFormat},on:{input:t.picker2},model:{value:t.date2,callback:function(e){t.date2=e},expression:"date2"}})],1)],1)],1)},n=[],a=(i("64f2"),{name:"InputDateft",model:{prop:"value",event:"input"},model2:{prop:"value2",event:"input2"},props:{value:String,value2:String,readonly:Boolean},data(){return{modal:!1,date:"",modal2:!1,date2:""}},watch:{date2(t){this.$emit("update:value2",t)}},methods:{onInput(t){this.$emit("input",t)},picker(){this.onInput(this.date),this.close()},open(){const t=/^\d{4}-\d{2}-\d{2}$/;this.date=t.test(this.value)?this.value:this.date,this.modal=!0},close(){this.modal=!1,this.modal2=!1},onInput2(t){this.$emit("input2",t)},picker2(){this.onInput2(this.date2),this.close()},open2(){const t=/^\d{4}-\d{2}-\d{2}$/;this.date2=t.test(this.value2)?this.value2:this.date2,this.modal2=!0},dayFormat(t){if(!this.modal&&!this.modal2)return;const e=t.split("-");return Number(e[e.length-1])}}}),o=a,l=i("2877"),r=Object(l["a"])(o,s,n,!1,null,null,null);e["a"]=r.exports}}]);
//# sourceMappingURL=Invoice.c7d70a1b.js.map
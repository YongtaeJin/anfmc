(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["kPIManager"],{"414b":function(t,e,i){"use strict";var s=function(){var t=this,e=t._self._c;return e("v-tooltip",{attrs:{top:""},scopedSlots:t._u([{key:"activator",fn:function({on:i,attrs:s}){return[e("v-btn",t._g(t._b({class:t.childClass,on:{click:function(e){return t.$emit("click")}}},"v-btn",{...s,...t.$attrs},!1),i),[t._t("default")],2)]}}],null,!0)},[e("span",[t._v(t._s(t.label))])])},a=[],l={name:"TooltipBtn",props:{label:{type:String,required:!0},childClass:[String,Object]}},r=l,o=i("2877"),n=Object(o["a"])(r,s,a,!1,null,null,null);e["a"]=n.exports},a2e4:function(t,e,i){"use strict";var s=function(){var t=this,e=t._self._c;return e("v-dialog",t._b({model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},"v-dialog",t.$attrs,!1),[e("v-card",[e("v-toolbar",[e("v-toolbar-title",[t._v(t._s(t.label))]),e("v-spacer"),t.obtn?e("v-btn",{attrs:{color:"primary",small:""},on:{click:t.btnClick}},[t._v(" "+t._s(t.obtn)+" ")]):t._e(),e("v-btn",{attrs:{icon:""},on:{click:t.close}},[e("v-icon",[t._v("mdi-close")])],1)],1),e("v-card-text",[t._t("default")],2)],1)],1)},a=[],l={name:"ezDialog",props:{label:{type:String,required:!0},obtn:{type:String}},data(){return{dialog:!1}},methods:{close(){this.dialog=!1,this.$emit("onClose")},open(){this.$emit("onOpen"),this.dialog=!0},btnClick(){this.dialog=!1,this.$emit("btnClick")}}},r=l,o=i("2877"),n=Object(o["a"])(r,s,a,!1,null,null,null);e["a"]=n.exports},fb7c:function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t._self._c;return e("v-container",{attrs:{fluid:""}},[e("v-toolbar",{attrs:{height:"40px","background-color":"primary",dark:""}},[e("v-toolbar-title",[t._v("KPI 핵심성과지표 관리")]),e("v-spacer"),t._v(" 사업장 : "),e("v-select",{staticStyle:{width:"20px","max-width":"100px"},attrs:{"hide-details":"",dense:"",items:t.workSite,"item-text":"n_com","item-value":"c_com"},model:{value:t.form.c_com,callback:function(e){t.$set(t.form,"c_com",e)},expression:"form.c_com"}}),t._v(" 조회년월 : "),e("tooltip-btn",{attrs:{label:"전월"},on:{click:t.prevMon}},[e("v-icon",[t._v("mdi-chevron-left")])],1),t._v(" "+t._s(t.cleandarYM)+" "),e("tooltip-btn",{attrs:{label:"다음월"},on:{click:t.nextMon}},[e("v-icon",[t._v("mdi-chevron-right")])],1),e("tooltip-btn",{attrs:{label:"조회"},on:{click:t.view}},[e("v-icon",[t._v("mdi-magnify")])],1)],1),e("v-row",[e("v-col",{attrs:{col:"12",sm:"6",md:"6"}},[e("v-toolbar",{attrs:{height:"30px",color:"accent"}},[e("v-toolbar-title",[t._v("KPI 인증상호: "+t._s(t.setCom.n_com))]),e("v-spacer"),e("v-toolbar-title",[t._v("인증키값: "+t._s(t.setCom.i_kpikey))])],1),e("v-data-table",{ref:"table",staticClass:"elevation-1 text-no-wrap",attrs:{headers:t.masterHead,items:t.masters,"item-key":"s_day","single-select":"","hide-default-footer":"","items-per-page":-1,"footer-props":{"items-per-page-options":[10,20,30,40,50,100,-1]},"item-class":t.row_classes,height:t.iframeHeight},on:{"click:row":t.rowSelectMaster},model:{value:t.selectedM,callback:function(e){t.selectedM=e},expression:"selectedM"}})],1),e("v-col",{attrs:{col:"12",sm:"6",md:"6"}},[e("v-toolbar",{attrs:{height:"30px",color:"#c2fad8"}},[e("v-toolbar-title",[t._v("선택일자 : "+t._s(t.getDate))])],1),e("v-row",[e("v-col",[e("v-toolbar",{attrs:{height:"30px","background-color":"primary",dark:""}},[e("v-toolbar-title",[t._v("KPI 1")]),e("v-spacer"),e("tooltip-btn",{attrs:{"x-small":"",label:"KPI1 추가"},on:{click:function(e){return t.addKpi("kpi1")}}},[e("v-icon",[t._v("mdi-plus-circle-multiple-outline")])],1)],1),e("v-data-table",{ref:"kpi1",staticClass:"elevation-1 text-no-wrap",attrs:{headers:t.kpi1Head,items:t.kpi1ItemFiled,"item-key":"t_no","single-select":"","hide-default-footer":"","items-per-page":-1,"item-class":t.row_classes,height:"150px","max-height":"150px"},on:{"click:row":t.rowSelectKpi1},scopedSlots:t._u([{key:"item.f_err",fn:function({item:e}){return[t._v(" "+t._s(t.getErrName(e.f_err))+" ")]}}],null,!0),model:{value:t.kip1S,callback:function(e){t.kip1S=e},expression:"kip1S"}})],1)],1),e("v-row",[e("v-col",[e("v-toolbar",{attrs:{height:"30px","background-color":"primary",dark:""}},[e("v-toolbar-title",[t._v("KPI 2")]),e("v-spacer"),e("tooltip-btn",{attrs:{"x-small":"",label:"KPI2 추가"},on:{click:function(e){return t.addKpi("kpi2")}}},[e("v-icon",[t._v("mdi-plus-circle-multiple-outline")])],1)],1),e("v-data-table",{ref:"kpi2",staticClass:"elevation-1 text-no-wrap",attrs:{headers:t.kpi2Head,items:t.kpi2ItemFiled,"item-key":"t_no","single-select":"","hide-default-footer":"","items-per-page":-1,"item-class":t.row_classes,height:"150px","max-height":"150px"},on:{"click:row":t.rowSelectKpi2},scopedSlots:t._u([{key:"item.f_err",fn:function({item:e}){return[t._v(" "+t._s(t.getErrName(e.f_err))+" ")]}}],null,!0),model:{value:t.kip2S,callback:function(e){t.kip2S=e},expression:"kip2S"}})],1)],1),e("v-row",[e("v-col",[e("v-toolbar",{attrs:{height:"30px","background-color":"primary",dark:""}},[e("v-toolbar-title",[t._v("KPI 3")]),e("v-spacer"),e("tooltip-btn",{attrs:{"x-small":"",label:"KPI3 추가"},on:{click:function(e){return t.addKpi("kpi3")}}},[e("v-icon",[t._v("mdi-plus-circle-multiple-outline")])],1)],1),e("v-data-table",{ref:"kpi3",staticClass:"elevation-1 text-no-wrap",attrs:{headers:t.kpi3Head,items:t.kpi3ItemFiled,"item-key":"t_no","single-select":"","hide-default-footer":"","items-per-page":-1,"item-class":t.row_classes,height:"150px","max-height":"150px"},on:{"click:row":t.rowSelectKpi3},scopedSlots:t._u([{key:"item.f_err",fn:function({item:e}){return[t._v(" "+t._s(t.getErrName(e.f_err))+" ")]}}],null,!0),model:{value:t.kip3S,callback:function(e){t.kip3S=e},expression:"kip3S"}})],1)],1)],1)],1),e("ez-dialog",{ref:"dialog_kpi",attrs:{label:"KPI 추가",persistent:"",width:"450px"},on:{onClose:t.kpi_close}},[e("kpi-manager-form",{attrs:{tabindex:t.kpiindex,data:t.setCom,resTime:t.ResTime}})],1)],1)},a=[],l=i("414b"),r=i("a2e4"),o=function(){var t=this,e=t._self._c;return e("div",{staticStyle:{height:"100%"}},[e("v-text-field",{staticStyle:{"max-width":"100px"},attrs:{label:"예약시간 : "},model:{value:t.form.s_restime,callback:function(e){t.$set(t.form,"s_restime",e)},expression:"form.s_restime"}}),e("input-date-4",{attrs:{label:"발생일시 : "},model:{value:t.form.s_day,callback:function(e){t.$set(t.form,"s_day",e)},expression:"form.s_day"}}),0==t.tabindex?e("label",{attrs:{for:"radio-group","hide-details":"",dense:""}},[t._v("시스템 가동여부 :")]):t._e(),0==t.tabindex?e("v-radio-group",{staticStyle:{margin:"0"},attrs:{row:"",dense:""},model:{value:t.form.systmOprYn,callback:function(e){t.$set(t.form,"systmOprYn",e)},expression:"form.systmOprYn"}},[e("v-radio",{attrs:{label:"가동",value:"Y"}}),e("v-radio",{attrs:{label:"중지",value:"N"}})],1):t._e(),t.tabindex>0?e("label",{attrs:{for:"radio-group","hide-details":"",dense:""}},[t._v("성과지표분야코드 :")]):t._e(),t.tabindex>0?e("v-radio-group",{staticStyle:{margin:"0"},attrs:{row:"",dense:""},model:{value:t.form.kpiFldCd,callback:function(e){t.$set(t.form,"kpiFldCd",e)},expression:"form.kpiFldCd"}},[e("v-radio",{attrs:{label:"생산",value:"P"},on:{click:function(e){return t.changeFild("P")}}}),e("v-radio",{attrs:{label:"원가",value:"C"},on:{click:function(e){return t.changeFild("C")}}}),e("v-radio",{attrs:{label:"품질",value:"Q"},on:{click:function(e){return t.changeFild("Q")}}}),e("v-radio",{attrs:{label:"납기",value:"D"},on:{click:function(e){return t.changeFild("D")}}})],1):t._e(),t.tabindex>0?e("label",{attrs:{dense:""}},[t._v("세부성과지표 :")]):t._e(),t.tabindex>0?e("div",{staticStyle:{display:"flex"}},[e("v-select",{attrs:{items:t.kpifildfilter,"item-text":"n_code","item-value":"c_code",dense:""},on:{change:t.onChangeKPIDt},model:{value:t.form.kpiDtlCd,callback:function(e){t.$set(t.form,"kpiDtlCd",e)},expression:"form.kpiDtlCd"}}),e("label",{attrs:{dense:""}},[t._v("       ")]),e("v-text-field",{staticStyle:{"max-width":"50px"},attrs:{label:"코드",readonly:"",dense:""},model:{value:t.form.kpiDtlCd,callback:function(e){t.$set(t.form,"kpiDtlCd",e)},expression:"form.kpiDtlCd"}}),e("label",{attrs:{dense:""}},[t._v("       ")]),e("v-text-field",{staticStyle:{"max-width":"50px"},attrs:{label:"단위",dense:""},model:{value:t.form.unt,callback:function(e){t.$set(t.form,"unt",e)},expression:"form.unt"}})],1):t._e(),1==t.tabindex?e("v-text-field",{staticStyle:{"max-width":"100px"},attrs:{label:"성치율 : ",dense:""},model:{value:t.form.achrt,callback:function(e){t.$set(t.form,"achrt",e)},expression:"form.achrt"}}):t._e(),2==t.tabindex?e("label",[t._v("측정수치 :")]):t._e(),2==t.tabindex?e("v-text-field",{staticStyle:{"max-width":"100px"},attrs:{dense:""},model:{value:t.form.msmtVl,callback:function(e){t.$set(t.form,"msmtVl",e)},expression:"form.msmtVl"}}):t._e(),e("v-btn",{attrs:{block:"",color:"primary"},on:{click:t.addd}},[t._v(" "+t._s(t.btnTitle))])],1)},n=[],c=(i("5b81e"),i("64f2")),m=i("4d81"),d=function(){var t=this,e=t._self._c;return e("v-dialog",{attrs:{persistent:"","max-width":"290"},scopedSlots:t._u([{key:"activator",fn:function({attrs:i}){return[e("v-text-field",t._b({staticStyle:{"max-width":"115px"},attrs:{value:t.value},on:{input:t.onInput},scopedSlots:t._u([{key:"append",fn:function(){return[e("v-btn",{attrs:{icon:"",small:"",tabindex:"-1"},on:{click:t.open}},[e("v-icon",[t._v("mdi-magnify")])],1)]},proxy:!0}],null,!0)},"v-text-field",{...t.$attrs,...i},!1))]}}]),model:{value:t.modal,callback:function(e){t.modal=e},expression:"modal"}},[e("v-card",[e("v-toolbar",[e("v-toolbar-title",[t._v(t._s(t.$attrs.label))]),e("v-spacer"),e("v-btn",{attrs:{icon:"",plain:""},on:{click:t.close}},[e("v-icon",[t._v("mdi-close")])],1)],1),e("v-date-picker",{attrs:{"no-title":"","day-format":t.dayFormat},on:{input:t.picker},model:{value:t.date,callback:function(e){t.date=e},expression:"date"}})],1)],1)},p=[],h={name:"InputDate",model:{prop:"value",event:"input"},props:{value:String},data(){return{modal:!1,date:""}},methods:{onInput(t){this.$emit("input",t)},open(){const t=/^\d{4}-\d{2}-\d{2}$/;this.date=t.test(this.value)?this.value:this.date,this.modal=!0},close(){this.modal=!1},picker(){this.onInput(this.date),this.close()},dayFormat(t){if(!this.modal)return;const e=t.split("-");return Number(e[e.length-1])}}},k=h,f=i("2877"),u=Object(f["a"])(k,d,p,!1,null,null,null),v=u.exports,_={components:{InputDate:m["a"],InputDate4:v},name:"kpiManagerForm",props:{tabindex:0,data:{c_com:"",n_com:"",i_kpikey:"",s_day:"",ocrDttm:""},resTime:""},created(){this.init("create")},watch:{tabindex:{deep:!0,handler(t,e){}},data:{deep:!0,handler(t,e){this.init()}}},computed:{chkRes(){return this.form.ocrDttm>Object(c["getYYYYmmdd"])()},btnTitle(){return this.chkRes?"예 약":"전 송"}},data(){return{tab:this.tabindex||0,row:null,form:{c_com:"",kpiCertKey:"",ocrDttm:"",s_restime:"",systmOprYn:"Y",kpiFldCd:"P",kpiDtlCd:"",kpiDtlNm:"",achrt:"",msmtVl:"",unt:"",trsDttm:"",f_tst:"N",i_kpilevel:"",s_day:"",f_sned:""},kpifilds:[],kpifildfilter:[],kpi1ResTime:"",kpi2ResTime:"",kpi3ResTime:""}},methods:{async init(t){"create"==t&&(this.kpifilds=await this.$axios.post("/api/kpi/getKpiFild"),this.kpifildfilter=this.kpifilds.filter((function(t){return"KPIP"==t.c_gcode}))),this.form.ocrDttm=this.data.ocrDttm,this.form.kpiCertKey=this.data.i_kpikey,this.form.s_day=this.data.s_day,this.form.s_restime=this.resTime},async addd(){this.form.c_com=this.data.c_com,this.form.ocrDttm=this.form.s_day.replaceAll("-",""),this.form.i_kpilevel=0==this.tabindex?"KPILEVEL1":1==this.tabindex?"KPILEVEL2":"KPILEVEL3",this.form.f_sned=this.chkRes?"예약":"전송",await this.$axios.post("/api/kpi/sendKPIJob",this.form),this.$toast.info(this.form.f_sned+" 처리 하였습니다 ...")},changeFild(t){this.kpifildfilter=this.kpifilds.filter((function(e){return e.c_gcode=="KPI"+t})),this.form.kpiDtlCd="",this.form.kpiDtlNm="",this.form.achrt="",this.form.msmtVl="",this.form.unt=""},onChangeKPIDt(t){const e=this.kpifildfilter.findIndex(e=>e.c_code==t);e>=0&&(this.form.kpiDtlNm=this.kpifildfilter[e].n_code,this.form.unt=this.kpifildfilter[e].s_buf1)}}},x=_,b=Object(f["a"])(x,o,n,!1,null,null,null),g=b.exports,y={components:{TooltipBtn:l["a"],KpiManagerForm:g,EzDialog:r["a"]},mounted(){window.addEventListener("resize",this.adjustIframeHeight),this.adjustIframeHeight(),this.init()},beforeDestroy(){window.removeEventListener("resize",this.adjustIframeHeight)},create(){},data(){return{iframeHeight:500,ym:{y:0,m:0},form:{c_com:"",s_ym:"",f_tst:"Y"},workSite:[],setCom:{c_com:"",n_com:"",i_kpikey:"",s_day:"",ocrDttm:""},kpiindex:0,masterHead:[{text:"날자",value:"s_day",sortable:!1,align:"center",width:"80px"},{text:"KPI1 예약시간",value:"s_k1time",sortable:!1,align:"center",width:"40px"},{text:"KPI1 전송건수",value:"m_k1sent",sortable:!1,align:"center",width:"40px"},{text:"KPI2 예약시간",value:"s_k2time",sortable:!1,align:"center",width:"40px"},{text:"KPI2 전송건수",value:"m_k2sent",sortable:!1,align:"center",width:"40px"},{text:"KPI3 예약시간",value:"s_k3time",sortable:!1,align:"center",width:"40px"},{text:"KPI3 전송건수",value:"m_k3sent",sortable:!1,align:"center",width:"40px"}],masters:[],masterinfo:[],selectedM:[],kpi1Head:[{text:"전송예약시간",value:"s_restime",sortable:!1,align:"center",width:"80px"},{text:"전송일시",value:"trsDttm",sortable:!1,align:"center",width:"80px"},{text:"시스템가동여부",value:"systmOprYn",sortable:!1,align:"center",width:"80px"},{text:"결과",value:"f_err",sortable:!1,align:"center",width:"80px"}],kpi1Items:[],kpi1ItemFiled:[],kpi1Info:[],kip1S:[],kpi2Head:[{text:"전송예약시간",value:"s_restime",sortable:!1,align:"center",width:"80px"},{text:"전송일시",value:"trsDttm",sortable:!1,align:"center",width:"80px"},{text:"성과지표분야코드",value:"kpiFldCd",sortable:!1,align:"center",width:"80px"},{text:"세부성과지표코드",value:"kpiDtlCd",sortable:!1,align:"center",width:"80px"},{text:"세부성과지표명",value:"kpiDtlNm",sortable:!1,align:"center",width:"80px"},{text:"성치율",value:"achrt",sortable:!1,align:"center",width:"80px"},{text:"결과",value:"f_err",sortable:!1,align:"center",width:"80px"}],kpi2Items:[],kpi2ItemFiled:[],kpi2Info:[],kip2S:[],kpi3Head:[{text:"전송예약시간",value:"s_restime",sortable:!1,align:"center",width:"80px"},{text:"전송일시",value:"trsDttm",sortable:!1,align:"center",width:"80px"},{text:"성과지표분야코드",value:"kpiFldCd",sortable:!1,align:"center",width:"80px"},{text:"세부성과지표코드",value:"kpiDtlCd",sortable:!1,align:"center",width:"80px"},{text:"세부성과지표명",value:"kpiDtlNm",sortable:!1,align:"center",width:"80px"},{text:"측정수치",value:"msmtVl",sortable:!1,align:"center",width:"80px"},{text:"단위",value:"unt",sortable:!1,align:"center",width:"80px"},{text:"결과",value:"f_err",sortable:!1,align:"center",width:"80px"}],kpi3Items:[],kpi3ItemFiled:[],kpi3Info:[],kip3S:[],kpiResTime:[],ResTime:"",kpiPopTitle:""}},computed:{cleandarYM(){return`${this.ym.y}년 ${String(this.ym.m+1).padStart(2,"0")}월`},kpic_com(){const t=this.workSite.findIndex(t=>t.c_com==this.form.c_com);if(t>=0)return this.workSite[t].c_com},kpiCom(){const t=this.workSite.findIndex(t=>t.c_com==this.form.c_com);if(t>=0)return this.workSite[t].n_kpiconm},kpiKey(){const t=this.workSite.findIndex(t=>t.c_com==this.form.c_com);if(t>=0)return this.workSite[t].i_kpikey},getDate(){return this.masterinfo.s_day}},watch:{ym:{deep:!0,handler(t,e){this.form.s_ym=this.yyyymm()}},systmOprYn:{handler(t,e){}}},methods:{adjustIframeHeight(){const t=window.innerHeight;this.iframeHeight=t-200},async init(){const t=new Date(Date.now());this.ym.y=t.getFullYear(),this.ym.m=t.getMonth(),this.workSite=await this.$axios.post("/api/kpi/getWorksite")},yyyymm(){return`${this.ym.y}${String(this.ym.m+1).padStart(2,"0")}`},prevMon(){0==this.ym.m?(this.ym.m=11,this.ym.y=this.ym.y-1):this.ym.m=this.ym.m-1},nextMon(){11==this.ym.m?(this.ym.m=0,this.ym.y=this.ym.y+1):this.ym.m=this.ym.m+1},getErrName(t){return"N"==t?"성공":"Y"==t?"실패":"대기"},row_classes(t){if("1"==t.f_week||"7"==t.f_week)return"orange"},async view(){this.setCom.c_com=this.kpic_com,this.setCom.n_com=this.kpiCom,this.setCom.i_kpikey=this.kpiKey,this.masterinfo=[],this.selectedM=[],this.masters=await this.$axios.post("/api/kpi/getResKpi",this.form),this.kpiResTime=await this.$axios.post("/api/kpi/getKPITime",this.form),this.kpi1Items=await this.$axios.post("/api/kpi/getKPI1List",this.form),this.kpi2Items=await this.$axios.post("/api/kpi/getKPI2List",this.form),this.kpi3Items=await this.$axios.post("/api/kpi/getKPI3List",this.form)},async rowSelectMaster(t,e){this.masterinfo.s_day!=t.s_day&&(this.masterinfo=t,e?e.select(!0):this.selectedM=[t],this.kpi1ItemFiled=this.kpi1Items.filter(e=>e.ocrDttm===t.s_date),this.kpi2ItemFiled=this.kpi2Items.filter(e=>e.ocrDttm===t.s_date),this.kpi3ItemFiled=this.kpi3Items.filter(e=>e.ocrDttm===t.s_date))},async rowSelectKpi1(t,e){this.kpi1Info.t_no!=t.t_no&&(this.kpi1Info=t,e?e.select(!0):this.kip1S=[t])},async rowSelectKpi2(t,e){this.kpi2Info.t_no!=t.t_no&&(this.kpi2Info=t,e?e.select(!0):this.kip2S=[t])},async rowSelectKpi3(t,e){this.kpi3Info.t_no!=t.t_no&&(this.kpi3Info=t,e?e.select(!0):this.kip3S=[t])},async addKpi(t){this.kpiKey?(this.setCom.ocrDttm=this.masterinfo.s_date,this.setCom.s_day=this.masterinfo.s_day,this.kpiindex="kpi3"==t?2:"kpi2"==t?1:0,this.ResTime="kpi3"==t?this.kpiResTime.KPI3:"kpi2"==t?this.kpiResTime.KPI2:this.kpiResTime.KPI1,this.$refs.dialog_kpi.open()):this.$toast.warning("인증키값이 없습니다.")},async kpi_close(){}}},w=y,I=Object(f["a"])(w,s,a,!1,null,null,null);e["default"]=I.exports}}]);
//# sourceMappingURL=kPIManager.51b575d4.js.map
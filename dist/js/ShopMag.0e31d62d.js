(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["ShopMag"],{"205a":function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t._self._c;return e("v-container",{attrs:{fluid:""}},[e("v-toolbar",{attrs:{height:"40px","background-color":"primary",dark:""}},[e("v-toolbar-title",[t._v("사업관리")]),e("v-spacer"),0==this.tabs&&this.$store.state.user.member.i_level>9?e("tooltip-btn",{attrs:{fab:"",small:"",label:"사업추가"},on:{click:t.addShop}},[e("v-icon",[t._v("mdi-plus")])],1):t._e(),this.tabs>=1?e("tooltip-btn",{attrs:{fab:"",small:"",label:"첨부 서류 추가"},on:{click:t.addFile}},[e("v-icon",[t._v("mdi-arrow-up-bold-box-outline")])],1):t._e()],1),e("v-tabs",{attrs:{"background-color":"primary",dark:"",height:"35px"},model:{value:t.tabs,callback:function(e){t.tabs=e},expression:"tabs"}},[e("v-tab",{staticStyle:{flex:"1"},attrs:{value:"tbapage_1"}},[t._v("사업 내역")]),e("v-tab",{attrs:{value:"tbapage_2"}},[t._v("신청 서류")]),e("v-tab",{attrs:{value:"tbapage_3"}},[t._v("추가 서류")]),e("v-tab",{attrs:{value:"tbapage_4"}},[t._v("협약서 서류")])],1),e("v-card-text",[e("v-tabs-items",{model:{value:t.tabs,callback:function(e){t.tabs=e},expression:"tabs"}},[e("v-tab-item",[e("v-data-table",{ref:"shop-table",staticClass:"elevation-1 text-no-wrap",attrs:{headers:t.itemShopHead,items:t.itemShops,"item-key":"i_shop","single-select":"","items-per-page":-1,"hide-default-footer":"",height:t.iframeHeight},on:{"click:row":t.rowSelectitemShop,"dblclick:row":t.rowShopitemSet},scopedSlots:t._u([{key:"item.t_remark",fn:function({item:i}){return[e("div",{staticClass:"left-align"},[t._v(" "+t._s(i.t_remark))])]}}],null,!0)})],1),this.itemShopRow>=0?e("v-tab-item",[e("shopmag-file-form",{attrs:{addLists:this.fileAddsA},on:{edit:t.addFile}})],1):t._e(),this.itemShopRow>=0?e("v-tab-item",[e("shopmag-file-form",{attrs:{addLists:this.fileAddsB},on:{edit:t.addFile}})],1):t._e(),this.itemShopRow>=0?e("v-tab-item",[e("shopmag-file-form",{attrs:{addLists:this.fileAddsC},on:{edit:t.addFile}})],1):t._e()],1)],1),e("ez-dialog",{ref:"dialog_shop",attrs:{label:"사업 추가 / 수정","max-width":"400",dark:"",color:"primary",persistent:""}},[e("shopmag-update-form",{attrs:{isNew:t.isNew,shopinfo:t.itemShop,cbShopId:t.cbShopIdChk},on:{save:t.save1}})],1),e("ez-dialog",{ref:"dialog_file",attrs:{label:t.AddFileTitle(),"max-width":"400",dark:"",color:"primary",persistent:""}},[e("shopmag-file-add-form",{attrs:{addFileInfo:t.fileAdd,isNew:t.isAddNew,isLoading:t.isLoading,i_sort_max:t.i_sort_max,fgubun:this.tabs},on:{save:t.save2,onDelete:t.onDelete}})],1)],1)},a=[],o=(i("14d9"),i("414b")),l=i("a2e4"),n=function(){var t=this,e=t._self._c;return e("v-form",{ref:"form",attrs:{"lazy-validation":""},on:{submit:function(e){return e.preventDefault(),t.save.apply(null,arguments)}},model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[e("input-duplicate-check",{ref:"i_shop",attrs:{label:"사업번호",counter:"15",readonly:!t.isNew,"prepend-icon":"mdi-identifier",rules:t.rules.name({label:"사업번호"}),origin:t.originKey,cbCheck:t.cbShopId},model:{value:t.form.i_shop,callback:function(e){t.$set(t.form,"i_shop",e)},expression:"form.i_shop"}}),e("v-text-field",{attrs:{label:"사업명","prepend-icon":"mdi-briefcase"},model:{value:t.form.n_shop,callback:function(e){t.$set(t.form,"n_shop",e)},expression:"form.n_shop"}}),e("input-date",{attrs:{label:"사업시작일","prepend-icon":"mdi-calendar"},model:{value:t.form.d_date1,callback:function(e){t.$set(t.form,"d_date1",e)},expression:"form.d_date1"}}),e("input-date",{attrs:{label:"사업종료일","prepend-icon":"mdi-calendar"},model:{value:t.form.d_date2,callback:function(e){t.$set(t.form,"d_date2",e)},expression:"form.d_date2"}}),e("v-textarea",{attrs:{label:"신청서 설명"},model:{value:t.form.t_remark,callback:function(e){t.$set(t.form,"t_remark",e)},expression:"form.t_remark"}}),e("v-textarea",{attrs:{label:"협약서 설명"},model:{value:t.form.t_remark2,callback:function(e){t.$set(t.form,"t_remark2",e)},expression:"form.t_remark2"}}),e("v-btn",{attrs:{type:"submit",block:"",color:"primary",loading:t.isLoading}},[t._v(t._s(t.isNew?"추 가":"수 정"))])],1)},r=[],d=i("50d8"),f=i("64f2"),h=i("248f"),m=i.n(h),p=i("4d81"),c={components:{InputDuplicateCheck:d["a"],InputDate:p["a"]},props:{isNew:Boolean,isLoading:Boolean,shopinfo:{type:Object,default:null},cbShopId:{type:Function,default:null}},data(){return{valid:!0,form:{i_shop:"",n_shop:"",d_date1:"",d_date2:"",t_remark:"",t_remark2:""}}},watch:{shopinfo(){this.init()}},computed:{rules:()=>m.a,originKey(){return this.shopinfo?this.shopinfo.i_shop:""}},created(){this.init()},destroyed(){this.form=null},methods:{init(){this.shopinfo?this.form=Object(f["deepCopy"])(this.shopinfo):this.form={i_shop:"",n_shop:"",d_date1:"",d_date2:"",t_remark:"",t_remark2:""},this.$refs.form&&this.$refs.form.resetValidation()},async save(){if(this.$refs.form.validate(),await this.$nextTick(),!this.valid)return;if(!this.$refs.i_shop.validate())return;Object.keys(this.form);this.$emit("save",this.form)},onClose(){console.log("onClose")}}},_=c,u=i("2877"),b=Object(u["a"])(_,n,r,!1,null,null,null),v=b.exports,g=function(){var t=this,e=t._self._c;return e("v-form",{ref:"form",attrs:{"lazy-validation":""},on:{submit:function(e){return e.preventDefault(),t.save.apply(null,arguments)},"@submit":function(e){return e.preventDefault(),t.edit.apply(null,arguments)}},model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[e("v-data-table",{staticClass:"elevation-1 text-no-wrap",attrs:{headers:t.headers,items:t.form,"single-select":"","item-key":"i_ser","items-per-page":-1,"hide-default-footer":""},scopedSlots:t._u([{key:"item",fn:function({item:i}){return[e("tr",{staticClass:"center-align",class:{row_select:i===t.selected},on:{click:function(e){return t.selectItem(i)},dblclick:function(e){return t.showRowInfo()}}},[e("td",{class:{red2:1==i.f_yn,green2:2==i.f_yn,blue2:3==i.f_yn}},[t._v(" "+t._s("1"==i.f_gubun?"신청서":"2"==i.f_gubun?"추가정보":"협약서")+" ")]),e("td",{class:{red2:1==i.f_yn,green2:2==i.f_yn,blue2:3==i.f_yn}},[t._v(" "+t._s(i.i_sort)+" ")]),e("td",{class:{red2:1==i.f_yn,green2:2==i.f_yn,blue2:3==i.f_yn}},[t._v(" "+t._s("1"==i.f_yn?"필수":"선택")+" ")]),e("td",{class:{red2:1==i.f_yn,green2:2==i.f_yn,blue2:3==i.f_yn}},[t._v(" "+t._s(i.n_nm)+" ")]),e("td",{staticClass:"left-align",class:{red2:1==i.f_yn,green2:2==i.f_yn,blue2:3==i.f_yn}},[t._v(" "+t._s(i.n_file)+" ")]),e("td",{staticClass:"left-align"},[t._v(" "+t._s(i.t_remark)+" ")])])]}}])})],1)},x=[],w={name:"ShopmagFileForm",props:{addLists:{type:Array,default:null}},data(){return{valid:!0,headers:[{text:"구분",value:"f_gubun",sortable:!1,width:"60px",fixed:!0,align:"center"},{text:"순번",value:"i_sort",sortable:!1,width:"35px",fixed:!0,align:"center"},{text:"필수",value:"f_yn",sortable:!1,width:"50px",fixed:!0,align:"center"},{text:"명칭",value:"n_nm",sortable:!1,width:"75px",fixed:!0,align:"center"},{text:"첨부서류",value:"n_file",sortable:!1,width:"30%",fixed:!0,align:"center"},{text:"파일명",value:"t_filenm",sortable:!1,width:"20%x",fixed:!0,align:"center",align:" d-none"},{text:"비고",value:"t_remark",sortable:!1,width:"40%",align:"center"}],form:{i_shop:"",i_ser:"",f_gubun:"",f_yn:"",n_nm:"",n_file:"",t_filenm:"",t_remark:"",t_sample:"",i_sort:"",f_del:""},item:null,selected:[]}},watch:{addLists(){this.init()}},created(){this.init()},methods:{init(){this.addLists&&(this.form=Object(f["deepCopy"])(this.addLists))},async selectItem(t){this.selected!=t&&(this.selected=t)},async showRowInfo(){this.selected&&this.$emit("edit",this.selected)}}},y=w,k=Object(u["a"])(y,g,x,!1,null,null,null),S=k.exports,$=function(){var t=this,e=t._self._c;return e("v-form",{ref:"form",attrs:{"lazy-validation":""},on:{submit:function(e){return e.preventDefault(),t.save.apply(null,arguments)}},model:{value:t.valid,callback:function(e){t.valid=e},expression:"valid"}},[e("v-responsive",{staticClass:"ma-0 pa-0",attrs:{width:"60px"}},[e("v-text-field",{attrs:{label:"순번 : ",type:"number"},model:{value:t.form.i_sort,callback:function(e){t.$set(t.form,"i_sort",e)},expression:"form.i_sort"}})],1),e("v-radio-group",{attrs:{label:"필수 : ",row:""},model:{value:t.form.f_yn,callback:function(e){t.$set(t.form,"f_yn",e)},expression:"form.f_yn"}},[e("v-radio",{attrs:{label:"필수",value:"1"}}),e("v-radio",{attrs:{label:"선택",value:"0"}})],1),e("v-text-field",{attrs:{label:"명칭 : "},model:{value:t.form.n_nm,callback:function(e){t.$set(t.form,"n_nm",e)},expression:"form.n_nm"}}),e("v-text-field",{attrs:{label:"첨부서류 : "},model:{value:t.form.n_file,callback:function(e){t.$set(t.form,"n_file",e)},expression:"form.n_file"}}),e("div",{staticClass:"d-flex align-center"},[e("v-text-field",{attrs:{label:"첨부(양식)",readonly:""},on:{dblclick:function(e){return t.downLoad()}},model:{value:t.form.t_filenm,callback:function(e){t.$set(t.form,"t_filenm",e)},expression:"form.t_filenm"}}),e("v-file-input",{attrs:{label:"첨부변경","prepend-icon":null,multiple:!1},on:{change:function(e){return t.getFilename(e)}},model:{value:t.form.t_image,callback:function(e){t.$set(t.form,"t_image",e)},expression:"form.t_image"}}),t.form.t_filenm?e("v-checkbox",{attrs:{label:"삭제"},model:{value:t.form.f_del,callback:function(e){t.$set(t.form,"f_del",e)},expression:"form.f_del"}}):t._e()],1),e("v-textarea",{attrs:{label:"설명 : "},model:{value:t.form.t_remark,callback:function(e){t.$set(t.form,"t_remark",e)},expression:"form.t_remark"}}),e("v-btn",{attrs:{type:"submit",block:"",color:"primary",loading:t.isLoading}},[t._v(t._s(t.isNew?"추 가":"수 정"))]),t.isNew?t._e():e("v-btn",{attrs:{block:"",loading:t.isLoading},on:{click:t.onDelete}},[t._v("삭 제")])],1)},A=[],F=i("9e7e"),C={name:"ShopmagFileAddForm",props:{isNew:Boolean,isLoading:Boolean,i_sort_max:0,fgubun:null,addFileInfo:{type:Object,default:null}},data(){return{valid:!0,form:{i_shop:"",i_ser:"",f_gubun:"",f_yn:"",n_nm:"",n_file:"",t_filenm:"",t_remark:"",t_sample:null,i_sort:0,f_del:null,t_image:null}}},created(){this.init()},destroyed(){this.form=null},watch:{addFileInfo(){this.init()},fgubun(){this.init()},i_sort_max(){this.init()},isNew(){this.init()}},computed:{rules:()=>m.a},methods:{init(){this.addFileInfo?this.form=Object(f["deepCopy"])(this.addFileInfo):this.form={i_shop:"",i_ser:0,f_gubun:this.fgubun.toString(),f_yn:"1",n_nm:"",n_file:"",t_filenm:"",t_remark:"",t_sample:null,i_sort:this.i_sort_max+1,f_del:null,t_image:null},this.$refs.form&&this.$refs.form.resetValidation()},async save(){const t=new FormData,e=Object.keys(this.form);for(const i of e)t.append(i,this.form[i]);this.$emit("save",t)},async onDelete(){const t=await this.$ezNotify.confirm("삭제 하시겠습니까 ?",this.form.n_file);t&&this.$emit("onDelete",this.form)},async getFilename(t,e){t&&(this.form.t_sample=t.name,this.form.f_del=null)},async downLoad(){if(this.form.t_sample&&this.form.t_filenm){this.form.t_sample;const t=this.form.t_filenm,e=await this.$axios.get("/api/shopinfo/getFileDown?path="+this.form.t_sample);e?(Object(F["save"])(e,t),alert("File Donw load Click !!!!!")):await this.$ezNotify.alert("다운로드 실패 !!","오류")}}}},N=C,D=Object(u["a"])(N,$,A,!1,null,null,null),I=D.exports,j={components:{TooltipBtn:o["a"],EzDialog:l["a"],ShopmagUpdateForm:v,ShopmagFileForm:S,ShopmagFileAddForm:I},name:"ShopMag",data(){return{tabs:0,iframeHeight:500,isLoading:!1,isNew:!1,itemShops:[],itemShop:[],itemShopRow:-1,itemShopHead:[{text:"신청번호",value:"i_shop",sortable:!1,width:"100px",fixed:!0,align:"center"},{text:"사업명",value:"n_shop",sortable:!1,width:"35%",align:"center"},{text:"사업시작",value:"d_date1",sortable:!1,width:"150px",fixed:!0,align:"center"},{text:"사업종료",value:"d_date2",sortable:!1,width:"150px",fixed:!0,align:"center"},{text:"비고",value:"t_remark",sortable:!1,width:"35%",align:"center"}],idx:-1,isAddNew:!0,fileAdd:null,fileAddsA:[],fileAddsB:[],fileAddsC:[],i_sort_max:0}},mounted(){window.addEventListener("resize",this.adjustIframeHeight),this.adjustIframeHeight(),this.fetchData()},beforeDestroy(){window.removeEventListener("resize",this.adjustIframeHeight)},watch:{async tabs(){if(this.tabs<1)return;const t={i_shop:this.itemShop.i_shop,f_gubun:this.tabs.toString(),sortBy:"i_sort, i_ser desc"};1===this.tabs&&(this.fileAddsA=await this.$axios.post("/api/shopinfo/getShopMagFile",t)),2===this.tabs&&(this.fileAddsB=await this.$axios.post("/api/shopinfo/getShopMagFile",t)),3===this.tabs&&(this.fileAddsC=await this.$axios.post("/api/shopinfo/getShopMagFile",t))}},computed:{},methods:{AddFileTitle(){return 1==this.tabs?"신청 서류":2==this.tabs?" 추가 서류":"협약서 서류"},adjustIframeHeight(){const t=window.innerHeight;this.iframeHeight=t-200},async fetchData(){this.itemShops=await this.$axios.get("/api/shopinfo/getShopMag")},async addShop(){this.isNew=!0,this.itemShop=null,this.$refs.dialog_shop.open()},rowSelectitemShop:function(t,e){this.selected=t,e.select(!0),this.itemShop!=t&&(this.itemShop=t,this.itemShopRow=e.index)},rowShopitemSet(t){this.itemShop&&(this.isNew=!1,this.$refs.dialog_shop.open())},async cbShopIdChk(t){const e={field:"i_shop",value:t};return await this.$axios.post("/api/shopinfo/duplicateCheckShop",e)},async save1(t){const e=await this.$axios.post("/api/shopinfo/shopInfoSave",t);if(1==e.affectedRows||2==e.affectedRows){this.$toast.info(t.i_shop+" "+(this.isNew?"추가":"수정")+"  하였습니다.");const e=this.itemShops.indexOf(this.itemShop);if(e>=0)this.itemShops.splice(e,1,t);else{this.itemShops.push(t)}}this.$refs.dialog_shop.close()},async addFile(t){t?(this.fileAdd=Object(f["deepCopy"])(t),this.isAddNew=!1):(this.getSortMax(this.tabs),this.isAddNew=!0,this.fileAdd=null),this.$refs.dialog_file.open()},getSortMax(t){if(this.i_sort_max=0,1==t){if(this.fileAddsA)for(let e in this.fileAddsA)this.fileAddsA[e].i_sort>this.i_sort_max&&(this.i_sort_max=this.fileAddsA[e].i_sort)}else if(2==t){if(this.fileAddsB)for(let e in this.fileAddsB)this.fileAddsB[e].i_sort>this.i_sort_max&&(this.i_sort_max=this.fileAddsB[e].i_sort)}else if(3==t){if(this.fileAddsC)for(let e in this.fileAddsC)this.fileAddsC[e].i_sort>this.i_sort_max&&(this.i_sort_max=this.fileAddsC[e].i_sort)}else this.i_sort_max=0},async save2(t){t.append("isNew",this.isAddNew),t.append("i_shop_select",this.itemShop.i_shop);const e=await this.$axios.post("/api/shopinfo/shopAddFile",t);e>0&&(this.$toast.info((this.isAddNew?"추가":"수정")+" 하여습니다."),await this.reloadFile()),this.$refs.dialog_file.close()},async onDelete(t){const e=await $axios.post("/api/shopinfo/shopAddFileDelete",t);e&&(this.$toast.info("삭제 하여습니다."),await this.reloadFile()),this.$refs.dialog_file.close()},async reloadFile(){const t={i_shop:this.itemShop.i_shop,f_gubun:this.tabs.toString(),sortBy:"i_sort, i_ser desc"};1===this.tabs&&(this.fileAddsA=await this.$axios.post("/api/shopinfo/getShopMagFile",t)),2===this.tabs&&(this.fileAddsB=await this.$axios.post("/api/shopinfo/getShopMagFile",t)),3===this.tabs&&(this.fileAddsC=await this.$axios.post("/api/shopinfo/getShopMagFile",t))}}},L=j,O=Object(u["a"])(L,s,a,!1,null,null,null);e["default"]=O.exports},"414b":function(t,e,i){"use strict";var s=function(){var t=this,e=t._self._c;return e("v-tooltip",{attrs:{top:""},scopedSlots:t._u([{key:"activator",fn:function({on:i,attrs:s}){return[e("v-btn",t._g(t._b({class:t.childClass,on:{click:function(e){return t.$emit("click")}}},"v-btn",{...s,...t.$attrs},!1),i),[t._t("default")],2)]}}],null,!0)},[e("span",[t._v(t._s(t.label))])])},a=[],o={name:"TooltipBtn",props:{label:{type:String,required:!0},childClass:[String,Object]}},l=o,n=i("2877"),r=Object(n["a"])(l,s,a,!1,null,null,null);e["a"]=r.exports},a2e4:function(t,e,i){"use strict";var s=function(){var t=this,e=t._self._c;return e("v-dialog",t._b({model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},"v-dialog",t.$attrs,!1),[e("v-card",[e("v-toolbar",[e("v-toolbar-title",[t._v(t._s(t.label))]),e("v-spacer"),t.obtn?e("v-btn",{attrs:{color:"primary",small:""},on:{click:t.btnClick}},[t._v(" "+t._s(t.obtn)+" ")]):t._e(),e("v-btn",{attrs:{icon:""},on:{click:t.close}},[e("v-icon",[t._v("mdi-close")])],1)],1),e("v-card-text",[t._t("default")],2)],1)],1)},a=[],o={name:"ezDialog",props:{label:{type:String,required:!0},obtn:{type:String}},data(){return{dialog:!1}},methods:{close(){this.dialog=!1,this.$emit("onClose")},open(){this.$emit("onOpen"),this.dialog=!0},btnClick(){this.dialog=!1,this.$emit("btnClick")}}},l=o,n=i("2877"),r=Object(n["a"])(l,s,a,!1,null,null,null);e["a"]=r.exports}}]);
//# sourceMappingURL=ShopMag.0e31d62d.js.map